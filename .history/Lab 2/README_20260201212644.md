# GI·∫¢I TH√çCH CODE TCP/UDP

## M·ª§C L·ª§C
- [Ki·∫øn th·ª©c n·ªÅn t·∫£ng](#ki·∫øn-th·ª©c-n·ªÅn-t·∫£ng)
- [B√†i 1: Gi·∫£i ph∆∞∆°ng tr√¨nh b·∫≠c 2](#b√†i-1-gi·∫£i-ph∆∞∆°ng-tr√¨nh-b·∫≠c-2)
- [B√†i 2: Nh√¢n hai ma tr·∫≠n](#b√†i-2-nh√¢n-hai-ma-tr·∫≠n)
- [B√†i 3: Thay th·∫ø chu·ªói trong file](#b√†i-3-thay-th·∫ø-chu·ªói-trong-file)
- [B√†i 4: X·ª≠ l√Ω chu·ªói](#b√†i-4-x·ª≠-l√Ω-chu·ªói)
- [B√†i 5: Chat room](#b√†i-5-chat-room)

---

## Ki·∫øn th·ª©c n·ªÅn t·∫£ng

### TCP (Transmission Control Protocol)

**ƒê·∫∑c ƒëi·ªÉm:**
- **Connection-oriented**: Ph·∫£i thi·∫øt l·∫≠p k·∫øt n·ªëi tr∆∞·ªõc (3-way handshake)
- **Reliable**: ƒê·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫øn ƒë√≠ch ƒë·∫ßy ƒë·ªß, ƒë√∫ng th·ª© t·ª±
- **Flow control**: Ki·ªÉm so√°t t·ªëc ƒë·ªô g·ª≠i/nh·∫≠n ƒë·ªÉ kh√¥ng b·ªã tr√†n
- **Error checking**: T·ª± ƒë·ªông ph√°t hi·ªán l·ªói v√† g·ª≠i l·∫°i g√≥i tin b·ªã m·∫•t
- **Overhead**: T·ªën t√†i nguy√™n h∆°n (header 20-60 bytes)

**C∆° ch·∫ø 3-way handshake:**
```
Client                    Server
  ‚îÇ                         ‚îÇ
  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SYN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ  (Xin k·∫øt n·ªëi)
  ‚îÇ                         ‚îÇ
  ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SYN-ACK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  (ƒê·ªìng √Ω + x√°c nh·∫≠n)
  ‚îÇ                         ‚îÇ
  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ACK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ  (X√°c nh·∫≠n ho√†n t·∫•t)
  ‚îÇ                         ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ K·∫øt n·ªëi th√†nh c√¥ng ‚îÄ‚îÄ‚îò
```

**V√≠ d·ª•:**
```javascript
// TCP Server - net.createServer()
const server = net.createServer((socket) => {
    // socket ƒë·∫°i di·ªán cho 1 k·∫øt n·ªëi c·ªë ƒë·ªãnh
    socket.on('data', (data) => {
        // Nh·∫≠n d·ªØ li·ªáu t·ª´ ch√≠nh k·∫øt n·ªëi ƒë√≥
        socket.write(result);  // G·ª≠i l·∫°i cho ch√≠nh client ƒë√≥
    });
});

// TCP Client - client.connect()
client.connect(5000, '127.0.0.1', () => {
    // Ph·∫£i k·∫øt n·ªëi tr∆∞·ªõc m·ªõi g·ª≠i ƒë∆∞·ª£c
    client.write('Hello');  // G·ª≠i qua k·∫øt n·ªëi ƒë√£ thi·∫øt l·∫≠p
});
```

### UDP (User Datagram Protocol)

**ƒê·∫∑c ƒëi·ªÉm:**
- **Connectionless**: Kh√¥ng c·∫ßn thi·∫øt l·∫≠p k·∫øt n·ªëi, g·ª≠i tr·ª±c ti·∫øp
- **Unreliable**: Kh√¥ng ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫øn ƒë√≠ch (c√≥ th·ªÉ m·∫•t g√≥i tin)
- **No ordering**: G√≥i tin c√≥ th·ªÉ ƒë·∫øn kh√¥ng ƒë√∫ng th·ª© t·ª± g·ª≠i
- **Fast**: Nhanh h∆°n TCP (kh√¥ng c√≥ overhead k·∫øt n·ªëi)
- **Overhead**: Nh·∫π h∆°n (header ch·ªâ 8 bytes)

**C∆° ch·∫ø g·ª≠i nh·∫≠n:**
```
Client                    Server
  ‚îÇ                         ‚îÇ
  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ Data packet 1 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ  (c√≥ th·ªÉ ƒë·∫øn)
  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ Data packet 2 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ  (c√≥ th·ªÉ m·∫•t)
  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ Data packet 3 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ  (c√≥ th·ªÉ ƒë·∫øn tr∆∞·ªõc packet 1)
  ‚îÇ                         ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ Kh√¥ng c√≥ x√°c nh·∫≠n ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**V√≠ d·ª•:**
```javascript
// UDP Server - dgram.createSocket()
const server = dgram.createSocket('udp4');
server.on('message', (msg, rinfo) => {
    // rinfo ch·ª©a th√¥ng tin client (address, port)
    // Ph·∫£i ch·ªâ ƒë·ªãnh r√µ g·ª≠i cho ai
    server.send(result, rinfo.port, rinfo.address);
});

// UDP Client - g·ª≠i tr·ª±c ti·∫øp
const client = dgram.createSocket('udp4');
const msg = Buffer.from('Hello');
// Kh√¥ng c·∫ßn connect, g·ª≠i lu√¥n
client.send(msg, 5000, '127.0.0.1');
```

---

### So s√°nh TCP vs UDP

| Ti√™u ch√≠ | TCP | UDP |
|----------|-----|-----|
| **K·∫øt n·ªëi** | C·∫ßn thi·∫øt l·∫≠p tr∆∞·ªõc | Kh√¥ng c·∫ßn |
| **ƒê·ªô tin c·∫≠y** | 100% ƒë·∫£m b·∫£o ƒë·∫øn ƒë√≠ch | Kh√¥ng ƒë·∫£m b·∫£o |
| **Th·ª© t·ª±** | ƒê√∫ng th·ª© t·ª± g·ª≠i | C√≥ th·ªÉ sai th·ª© t·ª± |
| **T·ªëc ƒë·ªô** | Ch·∫≠m h∆°n | Nhanh h∆°n |
| **T√†i nguy√™n** | T·ªën nhi·ªÅu | √çt |
| **Ph√°t hi·ªán l·ªói** | C√≥, t·ª± ƒë·ªông g·ª≠i l·∫°i | Kh√¥ng |
| **Module Node.js** | `net` | `dgram` |
| **T·∫°o server** | `net.createServer()` | `dgram.createSocket()` |
| **G·ª≠i d·ªØ li·ªáu** | `socket.write(data)` | `socket.send(msg, port, address)` |
| **Nh·∫≠n d·ªØ li·ªáu** | `socket.on('data')` | `socket.on('message')` |
| **Bi·∫øt client** | T·ª± ƒë·ªông (qua socket) | Ph·∫£i l·∫•y t·ª´ `rinfo` |

**V√≠ d·ª•:**
```javascript
// TCP - G·ª≠i v√† nh·∫≠n ƒë∆°n gi·∫£n
socket.write('Hello');           // T·ª± bi·∫øt g·ª≠i cho ai
socket.on('data', (data) => {}); // T·ª± bi·∫øt nh·∫≠n t·ª´ ai

// UDP - Ph·∫£i ch·ªâ r√µ
socket.send(msg, 5000, '127.0.0.1');              // Ph·∫£i ch·ªâ ƒë·ªãnh port, address
socket.on('message', (msg, rinfo) => {            // rinfo ch·ª©a th√¥ng tin ng∆∞·ªùi g·ª≠i
    console.log(`T·ª´ ${rinfo.address}:${rinfo.port}`);
});
```

---

### Khi n√†o d√πng TCP?

**D√πng TCP khi:**
- **C·∫ßn ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫øn ƒë√≠ch ƒë·∫ßy ƒë·ªß**
- **Th·ª© t·ª± tin nh·∫Øn quan tr·ªçng**
- **Ch·∫•p nh·∫≠n ch·∫≠m h∆°n m·ªôt ch√∫t ƒë·ªÉ ƒë·ªïi l·∫•y ƒë·ªô tin c·∫≠y**

**V√≠ d·ª• th·ª±c t·∫ø:**

**B√†i 1 - Gi·∫£i ph∆∞∆°ng tr√¨nh:** D√πng TCP
- L√Ω do: Ph·∫£i ƒë·∫£m b·∫£o k·∫øt qu·∫£ ƒë√∫ng 100% g·ª≠i v·ªÅ client
- N·∫øu m·∫•t k·∫øt qu·∫£ ‚Üí user kh√¥ng bi·∫øt nghi·ªám c·ªßa ph∆∞∆°ng tr√¨nh

**B√†i 2 - Nh√¢n ma tr·∫≠n:** D√πng TCP
- L√Ω do: Ma tr·∫≠n c√≥ nhi·ªÅu s·ªë, m·∫•t 1 s·ªë ‚Üí k·∫øt qu·∫£ sai ho√†n to√†n
- C·∫ßn ƒë·∫£m b·∫£o to√†n b·ªô ma tr·∫≠n g·ª≠i ƒë·ªß

**B√†i 3 - Thay th·∫ø file:** D√πng TCP
- L√Ω do: File text ph·∫£i ƒë·∫ßy ƒë·ªß, m·∫•t 1 d√≤ng ‚Üí file b·ªã h·ªèng
- C·∫ßn ƒë·∫£m b·∫£o n·ªôi dung file nguy√™n v·∫πn

**B√†i 4 - X·ª≠ l√Ω chu·ªói:** D√πng TCP
- L√Ω do: L·ªánh v√† tham s·ªë ph·∫£i ƒë·∫ßy ƒë·ªß
- N·∫øu m·∫•t tham s·ªë ‚Üí server x·ª≠ l√Ω sai

**B√†i 5 - Chat room:** D√πng TCP
- L√Ω do: Tin nh·∫Øn ph·∫£i ƒë·∫øn ƒë·∫ßy ƒë·ªß, ƒë√∫ng th·ª© t·ª±
- N·∫øu m·∫•t tin ‚Üí cu·ªôc tr√≤ chuy·ªán kh√¥ng hi·ªÉu ƒë∆∞·ª£c

**C√°c ·ª©ng d·ª•ng kh√°c d√πng TCP:**
- Web browsing (HTTP/HTTPS)
- Email (SMTP, POP3, IMAP)
- File transfer (FTP, SFTP)
- Remote access (SSH, Telnet)
- Database connections

---

### Khi n√†o d√πng UDP?

**D√πng UDP khi:**
- **T·ªëc ƒë·ªô quan tr·ªçng h∆°n ƒë·ªô tin c·∫≠y**
- **Ch·∫•p nh·∫≠n m·∫•t m·ªôt √≠t d·ªØ li·ªáu**
- **D·ªØ li·ªáu g·ª≠i th∆∞·ªùng xuy√™n, li√™n t·ª•c**
- **ƒê·ªô tr·ªÖ (latency) ph·∫£i th·∫•p**

**V√≠ d·ª• th·ª±c t·∫ø:**

**Video call (Zoom, Skype):**
- M·∫•t v√†i frame video ‚Üí kh√¥ng sao, v·∫´n xem ƒë∆∞·ª£c
- Quan tr·ªçng l√† real-time, kh√¥ng b·ªã gi·∫≠t lag
- TCP ch·∫≠m ‚Üí b·ªã delay, kh√¥ng real-time

**Game online (PUBG, LOL, Valorant):**
- V·ªã tr√≠ nh√¢n v·∫≠t c·∫≠p nh·∫≠t li√™n t·ª•c (60 l·∫ßn/gi√¢y)
- M·∫•t 1-2 g√≥i tin ‚Üí kh√¥ng ·∫£nh h∆∞·ªüng l·ªõn (g√≥i tin ti·∫øp theo ƒë√£ c·∫≠p nh·∫≠t v·ªã tr√≠ m·ªõi)
- TCP ch·∫≠m ‚Üí b·ªã lag, ch·∫øt m·∫•t

**Live streaming (YouTube Live, Twitch):**
- Stream video/audio li√™n t·ª•c
- M·∫•t v√†i khung h√¨nh ‚Üí ng∆∞·ªùi xem kh√¥ng nh·∫≠n ra
- Quan tr·ªçng l√† m∆∞·ª£t, kh√¥ng ƒë·ª©ng h√¨nh

**VoIP (g·ªçi ƒëi·ªán tho·∫°i qua m·∫°ng):**
- Gi·ªçng n√≥i real-time
- M·∫•t v√†i mili gi√¢y ‚Üí kh√¥ng ·∫£nh h∆∞·ªüng
- TCP ch·∫≠m ‚Üí tho·∫°i b·ªã delay, n√≥i kh√¥ng k·ªãp

**DNS lookup:**
- Ch·ªâ c·∫ßn h·ªèi 1 l·∫ßn: "google.com IP l√† g√¨?"
- N·∫øu kh√¥ng ƒë∆∞·ª£c ‚Üí h·ªèi l·∫°i, ƒë∆°n gi·∫£n
- Kh√¥ng c·∫ßn thi·∫øt l·∫≠p k·∫øt n·ªëi ph·ª©c t·∫°p nh∆∞ TCP

**Sensor data (IoT):**
- C·∫£m bi·∫øn g·ª≠i nhi·ªát ƒë·ªô m·ªói gi√¢y: 25¬∞C, 25¬∞C, 26¬∞C...
- M·∫•t 1 gi√° tr·ªã ‚Üí kh√¥ng sao, gi√° tr·ªã ti·∫øp theo ƒë√£ ƒë·∫øn
- Quan tr·ªçng l√† nhanh, t·ªën √≠t pin

---

### C√°c kh√°i ni·ªám JavaScript trong code

**1. Callback Function**
```javascript
// H√†m ƒë∆∞·ª£c truy·ªÅn nh∆∞ tham s·ªë, s·∫Ω ƒë∆∞·ª£c g·ªçi sau
function input(name, cb) {
    rl.question('Nh·∫≠p: ', (answer) => {
        cb(answer);  // G·ªçi callback v·ªõi k·∫øt qu·∫£
    });
}
```

**2. Arrow Function**
```javascript
// C√∫ ph√°p ng·∫Øn g·ªçn
(param) => { return value }

// T∆∞∆°ng ƒë∆∞∆°ng:
function(param) { return value }
```

**3. Destructuring**
```javascript
// L·∫•y gi√° tr·ªã t·ª´ object
const { m1, m2 } = { m1: [[1,2]], m2: [[3,4]] };
// ‚Üí m1 = [[1,2]], m2 = [[3,4]]

// L·∫•y gi√° tr·ªã t·ª´ array
const [a, b, c] = [1, 2, 3];
// ‚Üí a = 1, b = 2, c = 3
```

**4. Spread Operator (...)**
```javascript
function processCommand(cmd, text, ...params) {
    // params l√† m·∫£ng ch·ª©a t·∫•t c·∫£ tham s·ªë c√≤n l·∫°i
}
processCommand('DELETE', 'hello', 0, 5);  
// ‚Üí cmd = 'DELETE', text = 'hello', params = [0, 5]
```

**5. JSON - Chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu**
```javascript
// Object ‚Üí String (ƒë·ªÉ g·ª≠i qua m·∫°ng)
const data = { m1: [[1,2]], m2: [[3,4]] };
const str = JSON.stringify(data);  
// ‚Üí '{"m1":[[1,2]],"m2":[[3,4]]}'

// String ‚Üí Object (sau khi nh·∫≠n)
const obj = JSON.parse(str);  
// ‚Üí { m1: [[1,2]], m2: [[3,4]] }
```

**6. Buffer - D·ªØ li·ªáu nh·ªã ph√¢n**
```javascript
// Socket nh·∫≠n/g·ª≠i d·ªØ li·ªáu d·∫°ng Buffer
socket.on('data', (data) => {
    const str = data.toString();  // Buffer ‚Üí String
});

const msg = Buffer.from('Hello');  // String ‚Üí Buffer
socket.write(msg);
```

---

## B√†i 1: Gi·∫£i ph∆∞∆°ng tr√¨nh b·∫≠c 2

### üìå M·ª•c ƒë√≠ch & ·ª®ng d·ª•ng

**M·ª•c ƒë√≠ch h·ªçc t·∫≠p:**
- Hi·ªÉu c√°ch thi·∫øt l·∫≠p k·∫øt n·ªëi TCP client-server
- H·ªçc c√°ch g·ª≠i/nh·∫≠n d·ªØ li·ªáu JSON qua m·∫°ng
- X·ª≠ l√Ω input t·ª´ ng∆∞·ªùi d√πng v√† t√≠nh to√°n tr√™n server

**·ª®ng d·ª•ng th·ª±c t·∫ø:**
1. **M√°y t√≠nh khoa h·ªçc t·ª´ xa**: T√≠nh to√°n ph·ª©c t·∫°p tr√™n server m·∫°nh, client ch·ªâ c·∫ßn g·ª≠i y√™u c·∫ßu
2. **C√¥ng c·ª• gi√°o d·ª•c**: H·ªçc sinh g·ª≠i b√†i t·∫≠p to√°n, server ch·∫•m v√† tr·∫£ k·∫øt qu·∫£
3. **API t√≠nh to√°n**: Microservice chuy√™n gi·∫£i c√°c ph∆∞∆°ng tr√¨nh to√°n h·ªçc
4. **·ª®ng d·ª•ng k·ªπ thu·∫≠t**: T√≠nh to√°n thi·∫øt k·∫ø k·ªπ thu·∫≠t (c·∫ßu, nh√†, m√°y m√≥c) c·∫ßn gi·∫£i ph∆∞∆°ng tr√¨nh

**T·∫°i sao d√πng TCP?**
- ‚úÖ K·∫øt qu·∫£ ph·∫£i ch√≠nh x√°c 100% (m·∫•t 1 s·ªë = sai k·∫øt qu·∫£)
- ‚úÖ D·ªØ li·ªáu nh·ªè, kh√¥ng c·∫ßn t·ªëc ƒë·ªô cao
- ‚úÖ Th√≠ch h·ª£p cho t√≠nh to√°n m·ªôt l·∫ßn, tr·∫£ k·∫øt qu·∫£ r√µ r√†ng

### File: `1_tcp_server.js`

```javascript
// D√≤ng 1: Import module 'net' ƒë·ªÉ l√†m vi·ªác v·ªõi TCP socket
const net = require('net');

// D√≤ng 3-14: H√†m gi·∫£i ph∆∞∆°ng tr√¨nh ax¬≤ + bx + c = 0
function solve(a, b, c) {
    // D√≤ng 4: T√≠nh delta theo c√¥ng th·ª©c Œî = b¬≤ - 4ac
    const delta = b * b - 4 * a * c;
    
    // D√≤ng 5: N·∫øu delta < 0 ‚Üí ph∆∞∆°ng tr√¨nh v√¥ nghi·ªám (kh√¥ng c√≥ nghi·ªám th·ª±c)
    if (delta < 0) return 'V√¥ nghi·ªám';
    
    // D√≤ng 6-9: N·∫øu delta = 0 ‚Üí nghi·ªám k√©p
    if (delta === 0) {
        // D√≤ng 7: T√≠nh nghi·ªám k√©p x = -b / (2a)
        const x = -b / (2 * a);
        // D√≤ng 8: Tr·∫£ v·ªÅ k·∫øt qu·∫£, toFixed(2) l√†m tr√≤n 2 ch·ªØ s·ªë th·∫≠p ph√¢n
        return `Nghi·ªám k√©p: x = ${x.toFixed(2)}`;
    }
    
    // D√≤ng 10-11: N·∫øu delta > 0 ‚Üí 2 nghi·ªám ph√¢n bi·ªát
    // Math.sqrt(delta) t√≠nh cƒÉn b·∫≠c 2 c·ªßa delta
    const x1 = (-b + Math.sqrt(delta)) / (2 * a);  // Nghi·ªám 1
    const x2 = (-b - Math.sqrt(delta)) / (2 * a);  // Nghi·ªám 2
    // D√≤ng 12: Tr·∫£ v·ªÅ c·∫£ 2 nghi·ªám
    return `x1 = ${x1.toFixed(2)}, x2 = ${x2.toFixed(2)}`;
}

// D√≤ng 16: T·∫°o TCP server
// net.createServer() nh·∫≠n callback ƒë∆∞·ª£c g·ªçi m·ªói khi c√≥ client k·∫øt n·ªëi
// Tham s·ªë 'socket' l√† k·∫øt n·ªëi v·ªõi client ƒë√≥
const server = net.createServer((socket) => {
    // D√≤ng 17: In th√¥ng b√°o khi c√≥ client k·∫øt n·ªëi
    console.log('Client k·∫øt n·ªëi!');
    
    // D√≤ng 18: L·∫Øng nghe s·ª± ki·ªán 'data' - khi nh·∫≠n d·ªØ li·ªáu t·ª´ client
    socket.on('data', (data) => {
        // D√≤ng 19: Chuy·ªÉn Buffer th√†nh String v√† x√≥a kho·∫£ng tr·∫Øng ƒë·∫ßu/cu·ªëi
        const input = data.toString().trim();
        
        // D√≤ng 20: T√°ch chu·ªói theo d·∫•u c√°ch, chuy·ªÉn m·ªói ph·∫ßn t·ª≠ th√†nh s·ªë
        // V√≠ d·ª•: "1 -5 6" ‚Üí ["1", "-5", "6"] ‚Üí [1, -5, 6]
        const nums = input.split(' ').map(Number);
        
        // D√≤ng 21: Destructuring - l·∫•y 3 ph·∫ßn t·ª≠ ƒë·∫ßu l√†m a, b, c
        const [a, b, c] = nums;
        
        // D√≤ng 23: In ra ph∆∞∆°ng tr√¨nh nh·∫≠n ƒë∆∞·ª£c
        console.log(`Nh·∫≠n: ${a}x¬≤ + ${b}x + ${c} = 0`);
        
        // D√≤ng 24: G·ªçi h√†m solve ƒë·ªÉ gi·∫£i ph∆∞∆°ng tr√¨nh
        const result = solve(a, b, c);
        
        // D√≤ng 25: G·ª≠i k·∫øt qu·∫£ v·ªÅ client qua socket
        socket.write(result);
        
        // D√≤ng 26: In k·∫øt qu·∫£ ƒë√£ g·ª≠i
        console.log(`G·ª≠i: ${result}\n`);
    });
});

// D√≤ng 30: Cho server l·∫Øng nghe tr√™n c·ªïng 5000
// Callback ƒë∆∞·ª£c g·ªçi khi server s·∫µn s√†ng
server.listen(5000, () => {
    console.log('Server ch·∫°y t·∫°i c·ªïng 5000\n');
});
```

### File: `1_tcp_client.js`

```javascript
// D√≤ng 1-2: Import c√°c module c·∫ßn thi·∫øt
const net = require('net');              // Module TCP socket
const readline = require('readline');    // Module ƒë·ªçc input t·ª´ console

// D√≤ng 3: T·∫°o m·ªôt socket client ƒë·ªÉ k·∫øt n·ªëi ƒë·∫øn server
const client = new net.Socket();

// D√≤ng 5-8: T·∫°o interface ƒë·ªÉ ƒë·ªçc input t·ª´ b√†n ph√≠m
const rl = readline.createInterface({
    input: process.stdin,    // ƒê·ªçc t·ª´ b√†n ph√≠m
    output: process.stdout   // Xu·∫•t ra console
});

// D√≤ng 10: K·∫øt n·ªëi ƒë·∫øn server
// Tham s·ªë: (port, host, callback khi k·∫øt n·ªëi th√†nh c√¥ng)
client.connect(5000, '127.0.0.1', () => {
    // D√≤ng 11-12: In th√¥ng b√°o khi k·∫øt n·ªëi th√†nh c√¥ng
    console.log('K·∫øt n·ªëi th√†nh c√¥ng!');
    console.log('Nh·∫≠p 3 s·ªë a b c (c√°ch nhau b·ªüi d·∫•u c√°ch)\n');
    
    // D√≤ng 13: G·ªçi h√†m ƒë·ªÉ b·∫Øt ƒë·∫ßu nh·∫≠p d·ªØ li·ªáu
    askInput();
});

// D√≤ng 16-20: H√†m h·ªèi ng∆∞·ªùi d√πng nh·∫≠p 3 s·ªë
function askInput() {
    // D√≤ng 17: Hi·ªÉn th·ªã prompt v√† ƒë·ª£i ng∆∞·ªùi d√πng nh·∫≠p
    rl.question('Nh·∫≠p a b c: ', (input) => {
        // D√≤ng 18: Khi ng∆∞·ªùi d√πng nh·∫•n Enter, g·ª≠i d·ªØ li·ªáu ƒë·∫øn server
        client.write(input);
    });
}

// D√≤ng 22-25: L·∫Øng nghe d·ªØ li·ªáu t·ª´ server
client.on('data', (data) => {
    // D√≤ng 23: In k·∫øt qu·∫£ nh·∫≠n ƒë∆∞·ª£c t·ª´ server
    console.log(`‚Üí ${data}\n`);
    
    // D√≤ng 24: H·ªèi ti·∫øp ƒë·ªÉ nh·∫≠p b·ªô s·ªë m·ªõi
    askInput();
});

// D√≤ng 27-30: X·ª≠ l√Ω khi k·∫øt n·ªëi b·ªã ƒë√≥ng
client.on('close', () => {
    // D√≤ng 28: In th√¥ng b√°o
    console.log('Ng·∫Øt k·∫øt n·ªëi');
    // D√≤ng 29: ƒê√≥ng readline interface
    rl.close();
});
```

---

## B√†i 2: Nh√¢n hai ma tr·∫≠n

### üìå M·ª•c ƒë√≠ch & ·ª®ng d·ª•ng

**M·ª•c ƒë√≠ch h·ªçc t·∫≠p:**
- H·ªçc c√°ch truy·ªÅn d·ªØ li·ªáu ph·ª©c t·∫°p (ma tr·∫≠n 2D) qua m·∫°ng
- S·ª≠ d·ª•ng JSON ƒë·ªÉ serialize/deserialize d·ªØ li·ªáu
- X·ª≠ l√Ω t√≠nh to√°n tr√™n server, client ch·ªâ hi·ªÉn th·ªã k·∫øt qu·∫£
- Hi·ªÉu c√°ch g·ª≠i/nh·∫≠n object/array qua TCP

**·ª®ng d·ª•ng th·ª±c t·∫ø:**
1. **X·ª≠ l√Ω ·∫£nh**: Ma tr·∫≠n pixel, filter, bi·∫øn ƒë·ªïi ·∫£nh (Photoshop, Instagram filters)
2. **Machine Learning**: Nh√¢n ma tr·∫≠n l√† ph√©p to√°n c∆° b·∫£n trong Neural Networks
3. **ƒê·ªì h·ªça 3D**: Bi·∫øn ƒë·ªïi t·ªça ƒë·ªô 3D trong game, phim ho·∫°t h√¨nh (Unity, Unreal Engine)
4. **Ki·ªÉm ƒë·ªãnh k·∫øt c·∫•u**: T√≠nh ·ª©ng su·∫•t trong x√¢y d·ª±ng, k·ªπ thu·∫≠t
5. **T√†i ch√≠nh**: Ph√¢n t√≠ch danh m·ª•c ƒë·∫ßu t∆∞, r·ªßi ro
6. **Khoa h·ªçc d·ªØ li·ªáu**: X·ª≠ l√Ω b·∫£ng d·ªØ li·ªáu l·ªõn (pandas, numpy)

**T·∫°i sao d√πng TCP?**
- ‚úÖ Ma tr·∫≠n c√≥ nhi·ªÅu s·ªë, m·∫•t 1 s·ªë = k·∫øt qu·∫£ sai ho√†n to√†n
- ‚úÖ Ph·∫£i ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßy ƒë·ªß v√† ƒë√∫ng th·ª© t·ª±
- ‚úÖ T√≠nh to√°n 1 l·∫ßn, kh√¥ng c·∫ßn real-time

### File: `2_tcp_server.js`

```javascript
// D√≤ng 1: Import module net
const net = require('net')

// D√≤ng 3-13: H√†m nh√¢n 2 ma tr·∫≠n
// Tham s·ªë: a = ma tr·∫≠n A[m√ón], b = ma tr·∫≠n B[n√óp]
// K·∫øt qu·∫£: ma tr·∫≠n C[m√óp]
function solve(a, b){
    // D√≤ng 4: Kh·ªüi t·∫°o m·∫£ng k·∫øt qu·∫£ r·ªóng
    const res = [];
    
    // D√≤ng 5: V√≤ng l·∫∑p qua t·ª´ng h√†ng c·ªßa ma tr·∫≠n A
    for(let i=0; i<a.length; ++i){
        // D√≤ng 6: T·∫°o h√†ng th·ª© i c·ªßa k·∫øt qu·∫£
        res[i] = [];
        
        // D√≤ng 7: V√≤ng l·∫∑p qua t·ª´ng c·ªôt c·ªßa ma tr·∫≠n B
        for(let j=0; j<b[0].length; ++j){
            // D√≤ng 8: Kh·ªüi t·∫°o ph·∫ßn t·ª≠ res[i][j] = 0
            res[i][j] = 0;
            
            // D√≤ng 9-10: T√≠nh t·ªïng t√≠ch
            // res[i][j] = a[i][0]*b[0][j] + a[i][1]*b[1][j] + ... + a[i][k]*b[k][j]
            for(let k=0; k<b.length; ++k)
                res[i][j] += a[i][k]*b[k][j];  // Nh√¢n v√† c·ªông d·ªìn
        }
    }
    // D√≤ng 12: Tr·∫£ v·ªÅ ma tr·∫≠n k·∫øt qu·∫£
    return res; 
}

// D√≤ng 15: T·∫°o TCP server
const server = net.createServer((socket) => {
    // D√≤ng 16: In th√¥ng b√°o khi client k·∫øt n·ªëi
    console.log('Client connect');
    
    // D√≤ng 17: L·∫Øng nghe d·ªØ li·ªáu t·ª´ client
    socket.on('data', (data) => {
        // D√≤ng 18: Parse JSON th√†nh object
        // Client g·ª≠i d·∫°ng: {"m1": [[1,2],[3,4]], "m2": [[5,6],[7,8]]}
        const {m1, m2} = JSON.parse(data);
        
        // D√≤ng 19: G·ªçi h√†m nh√¢n ma tr·∫≠n
        const ans = solve(m1, m2);
        
        // D√≤ng 20: In k·∫øt qu·∫£ ra console
        console.log('Ket qua', ans, '\n');
        
        // D√≤ng 21: Chuy·ªÉn k·∫øt qu·∫£ th√†nh JSON string v√† g·ª≠i v·ªÅ client
        socket.write(JSON.stringify(ans));
        
        // D√≤ng 22: In th√¥ng b√°o ƒë√£ g·ª≠i
        console.log('Gui');
    });
});

// D√≤ng 26: L·∫Øng nghe tr√™n c·ªïng 5000
server.listen(5000, () => {
    console.log('Serer chay ...')
});
```

### File: `2_tcp_client.js`

```javascript
// D√≤ng 1-2: Import module
const net = require('net');
const readline = require('readline');

// D√≤ng 4: T·∫°o socket client
const client = new net.Socket();

// D√≤ng 5: T·∫°o readline interface
const rl = readline.createInterface({ input: process.stdin, output: process.stdout });

// D√≤ng 7-16: H√†m hi·ªÉn th·ªã ma tr·∫≠n ƒë·∫πp
function show(m, name) {
    // D√≤ng 8: In t√™n ma tr·∫≠n
    console.log(`${name}:`);
    
    // D√≤ng 9: V√≤ng l·∫∑p qua t·ª´ng h√†ng
    for(let i=0; i<m.length; i++){
        // D√≤ng 10: T·∫°o chu·ªói cho 1 h√†ng, b·∫Øt ƒë·∫ßu b·∫±ng 2 d·∫•u c√°ch
        let row = '  ';
        
        // D√≤ng 11: V√≤ng l·∫∑p qua t·ª´ng c·ªôt
        for(let j=0; j<m[i].length; j++){
            // D√≤ng 12: Th√™m gi√° tr·ªã v√†o chu·ªói, c√°ch nhau 2 kho·∫£ng tr·∫Øng
            row += m[i][j] + '  ';
        }
        // D√≤ng 14: In chu·ªói h√†ng ra console
        console.log(row);
    }
}

// D√≤ng 17-31: H√†m nh·∫≠p ma tr·∫≠n t·ª´ ng∆∞·ªùi d√πng
// Tham s·ªë: name = t√™n ma tr·∫≠n, cb = callback function
function input(name, cb){
    // D√≤ng 18: H·ªèi k√≠ch th∆∞·ªõc ma tr·∫≠n (s·ªë h√†ng r, s·ªë c·ªôt c)
    rl.question(`${name} (K√≠ch th∆∞·ªõc n, m): `, (size) => {
        // D√≤ng 19: Parse th√†nh 2 s·ªë
        const [r, c] = size.split(' ').map(Number);
        
        // D√≤ng 20: H·ªèi nh·∫≠p t·∫•t c·∫£ c√°c s·ªë (r*c s·ªë)
        rl.question(`Nh·∫≠p ${r*c} s·ªë: `, (line) => {
            // D√≤ng 21: T√°ch chu·ªói th√†nh m·∫£ng s·ªë
            const n = line.split(' ').map(Number);
            
            // D√≤ng 22: Kh·ªüi t·∫°o ma tr·∫≠n r·ªóng
            const m = [];
            
            // D√≤ng 23: V√≤ng l·∫∑p t·∫°o t·ª´ng h√†ng
            for(let i=0; i<r; i++){
                // D√≤ng 24: T·∫°o h√†ng th·ª© i
                m[i] = [];
                
                // D√≤ng 25: V√≤ng l·∫∑p t·∫°o t·ª´ng c·ªôt
                for(let j=0; j<c; j++){
                    // D√≤ng 26: L·∫•y s·ªë t·ª´ m·∫£ng n theo c√¥ng th·ª©c: v·ªã tr√≠ = i*c + j
                    // V√≠ d·ª• r=2, c=2: [1,2,3,4] ‚Üí [[1,2],[3,4]]
                    m[i][j] = n[i*c + j];
                }
            }
            // D√≤ng 29: G·ªçi callback v·ªõi ma tr·∫≠n ƒë√£ t·∫°o
            cb(m);
        });
    });
}

// D√≤ng 33-36: K·∫øt n·ªëi ƒë·∫øn server
client.connect(5000, '127.0.0.1', () => {
    // D√≤ng 34: In th√¥ng b√°o k·∫øt n·ªëi OK
    console.log('OK\n');
    // D√≤ng 35: B·∫Øt ƒë·∫ßu nh·∫≠p li·ªáu
    ask();
});

// D√≤ng 38-44: H√†m ƒëi·ªÅu khi·ªÉn lu·ªìng nh·∫≠p li·ªáu
function ask(){
    // D√≤ng 39: Nh·∫≠p ma tr·∫≠n A
    input('Ma tr·∫≠n A : ', (m1) => {
        // D√≤ng 40: Sau khi nh·∫≠p xong A, nh·∫≠p ma tr·∫≠n B
        input('Ma tr·∫≠n B', (m2) => {
            // D√≤ng 41: In th√¥ng b√°o
            console.log('\nG·ª≠i l√™n server ...');
            
            // D√≤ng 42: G·ª≠i 2 ma tr·∫≠n d·∫°ng JSON ƒë·∫øn server
            client.write(JSON.stringify({ m1, m2 }));
        });
    });
}

// D√≤ng 46-51: Nh·∫≠n k·∫øt qu·∫£ t·ª´ server
client.on('data', (data) => {
    // D√≤ng 47: Parse JSON th√†nh ma tr·∫≠n v√† hi·ªÉn th·ªã
    show(JSON.parse(data), 'K·∫øt qu·∫£ ma tr·∫≠n A√óB');
    
    // D√≤ng 48: H·ªèi c√≥ mu·ªën ti·∫øp t·ª•c kh√¥ng
    rl.question('\nTi·∫øp? (y/n): ', (a) => {
        // D√≤ng 49: N·∫øu nh·∫≠p 'y', ti·∫øp t·ª•c
        if (a === 'y') ask();
        // D√≤ng 50: N·∫øu kh√¥ng, ƒë√≥ng k·∫øt n·ªëi
        else { client.destroy(); rl.close(); }
    });
});
```

---

## B√†i 3: Thay th·∫ø chu·ªói trong file

### üìå M·ª•c ƒë√≠ch & ·ª®ng d·ª•ng

**M·ª•c ƒë√≠ch h·ªçc t·∫≠p:**
- H·ªçc c√°ch x·ª≠ l√Ω file text qua m·∫°ng
- ƒê·ªçc/ghi file tr√™n server, client ch·ªâ g·ª≠i y√™u c·∫ßu
- S·ª≠ d·ª•ng m·∫£ng UDP (so s√°nh v·ªõi TCP)
- X·ª≠ l√Ω chu·ªói v√† thao t√°c file

**·ª®ng d·ª•ng th·ª±c t·∫ø:**
1. **C√¥ng c·ª• refactoring code**: T√¨m v√† thay t√™n bi·∫øn, h√†m trong project (VS Code Find & Replace)
2. **X·ª≠ l√Ω log files**: Thay th·∫ø sensitive data tr∆∞·ªõc khi share logs
3. **Content Management**: T·ª± ƒë·ªông c·∫≠p nh·∫≠t n·ªôi dung website, th√¥ng b√°o
4. **Template system**: Thay placeholder trong email template, document template
5. **Data migration**: Chuy·ªÉn ƒë·ªïi format d·ªØ li·ªáu c≈© sang m·ªõi
6. **Censorship/Filter**: Thay t·ª´ ng·ªØ nh·∫°y c·∫£m trong comment, chat

**T·∫°i sao d√πng UDP?**
- ‚úÖ Demo ph√¢n bi·ªát UDP vs TCP
- ‚úÖ N·ªôi dung file nh·ªè, g·ª≠i 1 l·∫ßn l√† ƒë·ªß
- üî∂ Th·ª±c t·∫ø n√™n d√πng TCP ƒë·ªÉ ƒë·∫£m b·∫£o file kh√¥ng b·ªã h·ªèng

### File: `3_tcp_server.js`

```javascript
// D√≤ng 1: Import module net
const net = require('net');

// D√≤ng 3-5: H√†m thay th·∫ø t·∫•t c·∫£ s1 th√†nh s2 trong content
function replaceAll(content, s1, s2) {
    // D√≤ng 4: Split chu·ªói theo s1, r·ªìi join l·∫°i b·∫±ng s2
    // V√≠ d·ª•: "Hello world Hello" v·ªõi s1="Hello", s2="Hi"
    // ‚Üí ["", " world ", ""] ‚Üí "Hi world Hi"
    return content.split(s1).join(s2);
}

// D√≤ng 7: T·∫°o TCP server
const server = net.createServer((socket) => {
    // D√≤ng 8: In th√¥ng b√°o
    console.log('Client k·∫øt n·ªëi!\n');
    
    // D√≤ng 10: L·∫Øng nghe d·ªØ li·ªáu t·ª´ client
    socket.on('data', (data) => {
        // D√≤ng 11-12: Parse JSON ƒë·ªÉ l·∫•y file content v√† 2 chu·ªói
        const request = JSON.parse(data.toString());
        const { fileContent, s1, s2 } = request;
        
        // D√≤ng 14-15: In th√¥ng tin nh·∫≠n ƒë∆∞·ª£c
        console.log(`Nh·∫≠n file (${fileContent.length} k√Ω t·ª±)`);
        console.log(`Thay th·∫ø: "${s1}" ‚Üí "${s2}"`);
        
        // D√≤ng 16: G·ªçi h√†m thay th·∫ø
        const result = replaceAll(fileContent, s1, s2);
        
        // D√≤ng 17: ƒê·∫øm s·ªë l·∫ßn xu·∫•t hi·ªán c·ªßa s1
        // C√°ch ƒë·∫øm: split theo s1 s·∫Ω t·∫°o ra (n+1) ph·∫ßn, v·ªõi n l√† s·ªë l·∫ßn xu·∫•t hi·ªán
        const count = (fileContent.split(s1).length - 1);
        
        // D√≤ng 19: In s·ªë l·∫ßn thay th·∫ø
        console.log(`ƒê√£ thay th·∫ø ${count} l·∫ßn\n`);
        
        // D√≤ng 20: G·ª≠i k·∫øt qu·∫£ v·ªÅ client d·∫°ng JSON
        socket.write(JSON.stringify({ result, count }));
    });
});

// D√≤ng 24: L·∫Øng nghe tr√™n c·ªïng 5002
server.listen(5002, () => {
    console.log('Server ch·∫°y t·∫°i c·ªïng 5002\n');
});
```

---

## B√†i 4: X·ª≠ l√Ω chu·ªói

### üìå M·ª•c ƒë√≠ch & ·ª®ng d·ª•ng

**M·ª•c ƒë√≠ch h·ªçc t·∫≠p:**
- X·ª≠ l√Ω nhi·ªÅu lo·∫°i command/request kh√°c nhau
- Parse v√† validate input t·ª´ client
- T·∫°o API ƒë∆°n gi·∫£n v·ªõi nhi·ªÅu operations
- S·ª≠ d·ª•ng switch-case ƒë·ªÉ route commands

**·ª®ng d·ª•ng th·ª±c t·∫ø:**
1. **Text Editor API**: C√°c t√≠nh nƒÉng edit text trong Google Docs, Word Online
2. **String validation service**: Ki·ªÉm tra v√† chu·∫©n h√≥a input (username, email, phone)
3. **Data preprocessing**: L√†m s·∫°ch d·ªØ li·ªáu tr∆∞·ªõc khi l∆∞u v√†o database
4. **Command-line tools**: C√¥ng c·ª• x·ª≠ l√Ω text trong Linux (sed, awk, grep)
5. **Format converter**: Chuy·ªÉn UPPER/lower case trong form, document
6. **Password generator**: X√≥a/ch√®n k√Ω t·ª± ƒë·∫∑c bi·ªát, t·∫°o password m·∫°nh

**T·∫°i sao d√πng TCP?**
- ‚úÖ L·ªánh v√† tham s·ªë ph·∫£i ƒë·∫ßy ƒë·ªß, ch√≠nh x√°c
- ‚úÖ M·∫•t tham s·ªë = server x·ª≠ l√Ω sai ho·∫∑c crash
- ‚úÖ Th√≠ch h·ª£p cho API pattern

### File: `4_tcp_server.js`

```javascript
// D√≤ng 1: Import module net
const net = require('net');

// D√≤ng 3-23: H√†m x·ª≠ l√Ω c√°c l·ªánh kh√°c nhau
// Tham s·ªë: cmd = t√™n l·ªánh, text = chu·ªói c·∫ßn x·ª≠ l√Ω, ...params = c√°c tham s·ªë th√™m
function processCommand(cmd, text, ...params) {
    // D√≤ng 4: Switch-case ki·ªÉm tra l·ªánh
    switch(cmd) {
        // D√≤ng 5-6: L·ªánh UPPER - chuy·ªÉn th√†nh ch·ªØ HOA
        case 'UPPER':
            return text.toUpperCase();
        
        // D√≤ng 7-8: L·ªánh LOWER - chuy·ªÉn th√†nh ch·ªØ th∆∞·ªùng
        case 'LOWER':
            return text.toLowerCase();
        
        // D√≤ng 9-12: L·ªánh DELETE - x√≥a 1 ƒëo·∫°n chu·ªói
        case 'DELETE':
            // D√≤ng 11: L·∫•y v·ªã tr√≠ b·∫Øt ƒë·∫ßu v√† k·∫øt th√∫c t·ª´ params
            const [start, end] = params.map(Number);
            // D√≤ng 12: C·∫Øt 2 ƒëo·∫°n v√† n·ªëi l·∫°i
            // V√≠ d·ª•: "hello world" v·ªõi start=0, end=5 ‚Üí "" + " world" = " world"
            return text.slice(0, start) + text.slice(end);
        
        // D√≤ng 13-17: L·ªánh INSERT - ch√®n chu·ªói con
        case 'INSERT':
            // D√≤ng 15-16: L·∫•y v·ªã tr√≠ v√† chu·ªói con c·∫ßn ch√®n
            const pos = Number(params[0]);
            const substr = params[1];
            // D√≤ng 17: C·∫Øt l√†m 2 ƒëo·∫°n, ch√®n substr v√†o gi·ªØa
            // V√≠ d·ª•: "hello" v·ªõi pos=5, substr=" world" ‚Üí "hello" + " world" + "" = "hello world"
            return text.slice(0, pos) + substr + text.slice(pos);
        
        // D√≤ng 18-19: L·ªánh kh√¥ng h·ª£p l·ªá
        default:
            return 'L·ªánh kh√¥ng h·ª£p l·ªá';
    }
}

// D√≤ng 22: T·∫°o TCP server
const server = net.createServer((socket) => {
    // D√≤ng 23: In th√¥ng b√°o
    console.log('Client k·∫øt n·ªëi!\n');
    
    // D√≤ng 25: L·∫Øng nghe d·ªØ li·ªáu t·ª´ client
    socket.on('data', (data) => {
        // D√≤ng 26-27: Parse d·ªØ li·ªáu
        // Format: "UPPER|hello world" ‚Üí ["UPPER", "hello world"]
        const parts = data.toString().split('|');
        // Destructuring: ph·∫ßn t·ª≠ ƒë·∫ßu l√† cmd, th·ª© 2 l√† text, c√≤n l·∫°i l√† params
        const [cmd, text, ...params] = parts;
        
        // D√≤ng 29-31: In th√¥ng tin nh·∫≠n ƒë∆∞·ª£c
        console.log(`L·ªánh: ${cmd}`);
        console.log(`Text: ${text}`);
        console.log(`Params: ${params.join(', ')}`);
        
        // D√≤ng 33: G·ªçi h√†m x·ª≠ l√Ω l·ªánh
        const result = processCommand(cmd, text, ...params);
        // D√≤ng 34: In k·∫øt qu·∫£
        console.log(`‚Üí ${result}\n`);
        
        // D√≤ng 36: G·ª≠i k·∫øt qu·∫£ v·ªÅ client
        socket.write(result);
    });
});

// D√≤ng 40-42: L·∫Øng nghe tr√™n c·ªïng 5003
server.listen(5003, () => {
    console.log('Server ch·∫°y c·ªïng 5003');
    console.log('L·ªánh: UPPER, LOWER, DELETE, INSERT\n');
});
```

---

## B√†i 5: Chat room

### üìå M·ª•c ƒë√≠ch & ·ª®ng d·ª•ng

**M·ª•c ƒë√≠ch h·ªçc t·∫≠p:**
- X·ª≠ l√Ω nhi·ªÅu clients ƒë·ªìng th·ªùi (concurrent connections)
- Broadcast message t·ªõi t·∫•t c·∫£ clients
- Qu·∫£n l√Ω danh s√°ch clients ƒëang online
- Ph√¢n bi·ªát TCP vs UDP trong chat application

**·ª®ng d·ª©ng th·ª±c t·∫ø:**

**TCP Chat (5_tcp_server/client.js):**
1. **Messaging apps**: Zalo, Telegram, WhatsApp, Facebook Messenger
2. **Team collaboration**: Slack, Microsoft Teams, Discord (text channels)
3. **Customer support**: Live chat tr√™n website, chatbot
4. **Online gaming chat**: Chat trong game MOBA, MMO
5. **Trading platforms**: Chat gi·ªØa traders, th√¥ng b√°o giao d·ªãch
6. **IoT monitoring**: Thi·∫øt b·ªã IoT g·ª≠i th√¥ng b√°o/warning

**UDP Chat (5_udp_server/client.js):**
1. **Voice/Video chat**: Discord voice, Zoom, Google Meet
2. **Live streaming chat**: Twitch, YouTube Live comments
3. **Multiplayer game**: V·ªã tr√≠ player update li√™n t·ª•c
4. **Real-time dashboard**: Stock prices, crypto prices update

**T·∫°i sao c√≥ c·∫£ TCP v√† UDP?**

**TCP Chat:**
- ‚úÖ Tin nh·∫Øn text ph·∫£i ƒë·∫øn ƒë·∫ßy ƒë·ªß, ƒë√∫ng th·ª© t·ª±
- ‚úÖ M·∫•t 1 tin = kh√¥ng hi·ªÉu cu·ªôc tr√≤ chuy·ªán
- ‚úÖ Tin nh·∫Øn quan tr·ªçng (h·ª£p ƒë·ªìng, giao d·ªãch, y t·∫ø)

**UDP Chat:**
- ‚úÖ T·ªëc ƒë·ªô quan tr·ªçng h∆°n (√¢m thanh, h√¨nh ·∫£nh real-time)
- ‚úÖ M·∫•t v√†i frame video/√¢m thanh kh√¥ng sao
- ‚úÖ Gi·∫£m delay, latency th·∫•p

**So s√°nh 2 phi√™n b·∫£n:**

| T√≠nh nƒÉng | TCP Version | UDP Version |
|----------|-------------|-------------|
| **ƒê·ªô tin c·∫≠y** | 100% ƒë·∫£m b·∫£o | C√≥ th·ªÉ m·∫•t tin |
| **Th·ª© t·ª±** | ƒê√∫ng th·ª© t·ª± g·ª≠i | C√≥ th·ªÉ l·ªôn x·ªôn |
| **T·ªëc ƒë·ªô** | Ch·∫≠m h∆°n | Nhanh h∆°n |
| **Use case** | Chat text | Voice/Video chat |
| **V√≠ d·ª•** | Zalo, Messenger | Discord voice, Zoom |

### File: `5_tcp_server.js`

```javascript
// D√≤ng 1-2: Import module
const net = require('net');
const readline = require('readline');

// D√≤ng 4: M·∫£ng l∆∞u t·∫•t c·∫£ client ƒëang k·∫øt n·ªëi
const clients = [];

// D√≤ng 5: T·∫°o TCP server
const server = net.createServer((socket) => {
    
    // D√≤ng 7: G·ª≠i y√™u c·∫ßu nh·∫≠p t√™n cho client m·ªõi
    socket.write('Nh·∫≠p t√™n c·ªßa b·∫°n: ');
    
    // D√≤ng 8-9: Bi·∫øn l∆∞u tr·∫°ng th√°i
    let username = '';     // T√™n ng∆∞·ªùi d√πng
    let isNamed = false;   // ƒê√£ nh·∫≠p t√™n ch∆∞a
    
    // D√≤ng 11: L·∫Øng nghe d·ªØ li·ªáu t·ª´ client
    socket.on('data', (data) => {
        // D√≤ng 12: L·∫•y message v√† x√≥a kho·∫£ng tr·∫Øng
        const msg = data.toString().trim();
        
        // D√≤ng 14-23: N·∫øu ch∆∞a nh·∫≠p t√™n
        if (!isNamed) {
            // D√≤ng 15: L∆∞u t√™n
            username = msg;
            
            // D√≤ng 16: Th√™m client v√†o danh s√°ch
            clients.push({ socket, username });
            
            // D√≤ng 17: In th√¥ng b√°o server
            console.log(`[+] ${username} tham gia (${clients.length} online)\n`);
            
            // D√≤ng 19: Th√¥ng b√°o cho t·∫•t c·∫£ client kh√°c
            broadcast(`[SERVER] ${username} ƒë√£ tham gia chat!`, socket);
            
            // D√≤ng 20: G·ª≠i l·ªùi ch√†o cho client v·ª´a v√†o
            socket.write(`Ch√†o ${username}! G√µ tin nh·∫Øn ƒë·ªÉ chat.\n\n`);
            
            // D√≤ng 21-22: ƒê√°nh d·∫•u ƒë√£ nh·∫≠p t√™n, tho√°t kh·ªèi h√†m
            isNamed = true;
            return;
        }
        
        // D√≤ng 25-26: N·∫øu ƒë√£ nh·∫≠p t√™n ‚Üí x·ª≠ l√Ω tin nh·∫Øn chat
        // Format tin nh·∫Øn: "[username]: message"
        const message = `[${username}]: ${msg}`;
        
        // D√≤ng 27: In tin nh·∫Øn ra server console
        console.log(message);
        
        // D√≤ng 28: G·ª≠i tin nh·∫Øn cho t·∫•t c·∫£ client (tr·ª´ ng∆∞·ªùi g·ª≠i)
        broadcast(message, socket);
        
        // D√≤ng 30-31: X√°c nh·∫≠n ƒë√£ g·ª≠i cho ng∆∞·ªùi g·ª≠i
        socket.write('‚úì ƒê√£ g·ª≠i\n');
    });
    
    // D√≤ng 34-41: X·ª≠ l√Ω khi client ng·∫Øt k·∫øt n·ªëi
    socket.on('close', () => {
        // D√≤ng 35-36: T√¨m v·ªã tr√≠ c·ªßa client trong m·∫£ng
        const index = clients.findIndex(c => c.socket === socket);
        
        // D√≤ng 37: N·∫øu t√¨m th·∫•y
        if (index !== -1) {
            // D√≤ng 38: X√≥a kh·ªèi m·∫£ng (1 ph·∫ßn t·ª≠ t·∫°i v·ªã tr√≠ index)
            clients.splice(index, 1);
            
            // D√≤ng 39: In th√¥ng b√°o server
            console.log(`[-] ${username} r·ªùi kh·ªèi (${clients.length} online)\n`);
            
            // D√≤ng 40: Th√¥ng b√°o cho t·∫•t c·∫£ client c√≤n l·∫°i
            broadcast(`[SERVER] ${username} ƒë√£ r·ªùi kh·ªèi!`);
        }
    });
});

// D√≤ng 44-50: H√†m broadcast - g·ª≠i tin nh·∫Øn cho t·∫•t c·∫£ client
// Tham s·ªë: message = n·ªôi dung, exclude = socket c·∫ßn lo·∫°i tr·ª´ (kh√¥ng g·ª≠i)
function broadcast(message, exclude = null) {
    // D√≤ng 45: Duy·ªát qua t·∫•t c·∫£ client
    clients.forEach(client => {
        // D√≤ng 46-48: N·∫øu kh√¥ng ph·∫£i client c·∫ßn lo·∫°i tr·ª´
        if (client.socket !== exclude) {
            // G·ª≠i tin nh·∫Øn
            client.socket.write(message + '\n');
        }
    });
}

// D√≤ng 52-57: L·∫Øng nghe tr√™n c·ªïng 5004
server.listen(5004, () => {
    console.log('='.repeat(40));
    console.log('  CHAT ROOM SERVER - TCP');
    console.log('  Port: 5004');
    console.log('='.repeat(40) + '\n');
});
```

---

## C√°ch ch·∫°y

```bash
# TCP - Lu√¥n ch·∫°y server tr∆∞·ªõc
node 1_tcp_server.js  # Terminal 1
node 1_tcp_client.js  # Terminal 2

# UDP (t∆∞∆°ng t·ª±)
node 1_udp_server.js
node 1_udp_client.js
```
