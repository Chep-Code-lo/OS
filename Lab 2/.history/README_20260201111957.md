# HÆ¯á»šNG DáºªN CHI TIáº¾T BÃ€I Táº¬P TCP/UDP

> **TÃ i liá»‡u Ä‘áº§y Ä‘á»§ vá» láº­p trÃ¬nh Socket vá»›i Node.js**

## ğŸ“‹ Má»¤C Lá»¤C
1. [Kiáº¿n thá»©c ná»n táº£ng](#kiáº¿n-thá»©c-ná»n-táº£ng)
2. [BÃ i 1: Giáº£i phÆ°Æ¡ng trÃ¬nh báº­c 2](#bÃ i-1-giáº£i-phÆ°Æ¡ng-trÃ¬nh-báº­c-2)
3. [BÃ i 2: NhÃ¢n hai ma tráº­n](#bÃ i-2-nhÃ¢n-hai-ma-tráº­n)
4. [BÃ i 3: Thay tháº¿ chuá»—i trong file](#bÃ i-3-thay-tháº¿-chuá»—i-trong-file)
5. [BÃ i 4: Xá»­ lÃ½ chuá»—i](#bÃ i-4-xá»­-lÃ½-chuá»—i)
6. [BÃ i 5: Chat room](#bÃ i-5-chat-room)
7. [So sÃ¡nh TCP vs UDP](#so-sÃ¡nh-tcp-vs-udp)
8. [API Reference](#api-reference)
9. [Best Practices](#best-practices)

---

## Kiáº¿n thá»©c ná»n táº£ng

### ğŸŒ MÃ´ hÃ¬nh Client-Server

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚  â”€â”€â”€â”€ Request â”€â”€â”€â”€>  â”‚  Server  â”‚
â”‚          â”‚                      â”‚          â”‚
â”‚          â”‚  <â”€â”€â”€ Response â”€â”€â”€â”€  â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng:**
1. **Server**: Láº¯ng nghe (listen) trÃªn má»™t port
2. **Client**: Káº¿t ná»‘i (connect) Ä‘áº¿n server
3. **Communication**: Trao Ä‘á»•i dá»¯ liá»‡u 2 chiá»u
4. **Close**: ÄÃ³ng káº¿t ná»‘i khi hoÃ n thÃ nh

### ğŸ“¡ TCP (Transmission Control Protocol)

**Äáº·c Ä‘iá»ƒm:**
- **Connection-oriented**: Cáº§n thiáº¿t láº­p káº¿t ná»‘i trÆ°á»›c (3-way handshake)
- **Reliable**: Äáº£m báº£o dá»¯ liá»‡u Ä‘áº¿n Ä‘Ã­ch Ä‘áº§y Ä‘á»§, Ä‘Ãºng thá»© tá»±
- **Flow control**: Kiá»ƒm soÃ¡t tá»‘c Ä‘á»™ gá»­i/nháº­n
- **Error checking**: Kiá»ƒm tra lá»—i vÃ  gá»­i láº¡i náº¿u máº¥t gÃ³i

**CÆ¡ cháº¿ 3-way handshake:**
```
Client                          Server
  â”‚                               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€ SYN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                               â”‚
  â”‚<â”€â”€â”€â”€â”€â”€ SYN-ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                               â”‚
  â”‚      Connection Established   â”‚
```

**Khi nÃ o dÃ¹ng TCP:**
- âœ… Truyá»n file (FTP, HTTP)
- âœ… Email (SMTP, POP3)
- âœ… Chat, messaging
- âœ… Remote access (SSH, Telnet)

### ğŸ“¡ UDP (User Datagram Protocol)

**Äáº·c Ä‘iá»ƒm:**
- **Connectionless**: KhÃ´ng cáº§n thiáº¿t láº­p káº¿t ná»‘i
- **Unreliable**: KhÃ´ng Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº¿n Ä‘Ã­ch
- **Fast**: Nhanh hÆ¡n TCP (Ã­t overhead)
- **No ordering**: GÃ³i tin cÃ³ thá»ƒ Ä‘áº¿n khÃ´ng Ä‘Ãºng thá»© tá»±

**CÆ¡ cháº¿ gá»­i nháº­n:**
```
Client                          Server
  â”‚                               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€ Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  (cÃ³ thá»ƒ máº¥t)
  â”‚                               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€ Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  (cÃ³ thá»ƒ Ä‘áº¿n)
  â”‚                               â”‚
  â”‚       No acknowledgment       â”‚
```

**Khi nÃ o dÃ¹ng UDP:**
- âœ… Video streaming (YouTube, Netflix)
- âœ… Game online (FPS, MOBA)
- âœ… VoIP (Skype, Zoom)
- âœ… DNS queries

---

## BÃ i 1: Giáº£i phÆ°Æ¡ng trÃ¬nh báº­c 2

### ğŸ“ MÃ´ táº£
Client gá»­i 3 sá»‘ `a, b, c` Ä‘áº¿n server. Server giáº£i phÆ°Æ¡ng trÃ¬nh `axÂ² + bx + c = 0` vÃ  gá»­i káº¿t quáº£ vá» client.

### ğŸš€ CÃ¡ch cháº¡y

**TCP:**
```bash
# Terminal 1
node 1_tcp_server.js

# Terminal 2
node 1_tcp_client.js
```

**UDP:**
```bash
# Terminal 1
node 1_udp_server.js

# Terminal 2
node 1_udp_client.js
```

### ğŸ’¡ VÃ­ dá»¥
```
Nháº­p a b c: 1 -5 6
â†’ x1 = 3.00, x2 = 2.00

Nháº­p a b c: 1 -4 4
â†’ Nghiá»‡m kÃ©p: x = 2.00

Nháº­p a b c: 1 2 5
â†’ VÃ´ nghiá»‡m
```

### ğŸ” Giáº£i thÃ­ch chi tiáº¿t code

#### **Server TCP - PhÃ¢n tÃ­ch tá»«ng dÃ²ng:**

```javascript
// 1. Import module net Ä‘á»ƒ lÃ m viá»‡c vá»›i TCP
const net = require('net');

// 2. HÃ m giáº£i phÆ°Æ¡ng trÃ¬nh báº­c 2: axÂ² + bx + c = 0
function solve(a, b, c) {
    // CÃ´ng thá»©c delta: Î” = bÂ² - 4ac
    const delta = b * b - 4 * a * c;
    
    // TrÆ°á»ng há»£p 1: delta < 0 â†’ VÃ´ nghiá»‡m (khÃ´ng cÃ³ nghiá»‡m thá»±c)
    if (delta < 0) return 'VÃ´ nghiá»‡m';
    
    // TrÆ°á»ng há»£p 2: delta = 0 â†’ Nghiá»‡m kÃ©p
    // CÃ´ng thá»©c: x = -b / 2a
    if (delta === 0) {
        const x = -b / (2 * a);
        return `Nghiá»‡m kÃ©p: x = ${x.toFixed(2)}`;
    }
    
    // TrÆ°á»ng há»£p 3: delta > 0 â†’ 2 nghiá»‡m phÃ¢n biá»‡t
    // CÃ´ng thá»©c: x = (-b Â± âˆšÎ”) / 2a
    const x1 = (-b + Math.sqrt(delta)) / (2 * a);
    const x2 = (-b - Math.sqrt(delta)) / (2 * a);
    return `x1 = ${x1.toFixed(2)}, x2 = ${x2.toFixed(2)}`;
}

// 3. Táº¡o TCP server vá»›i callback Ä‘Æ°á»£c gá»i khi cÃ³ client káº¿t ná»‘i
const server = net.createServer((socket) => {
    console.log('Client Ä‘Ã£ káº¿t ná»‘i');
    
    // 4. Láº¯ng nghe sá»± kiá»‡n 'data' - khi nháº­n dá»¯ liá»‡u tá»« client
    socket.on('data', (data) => {
        // 5. Chuyá»ƒn Buffer thÃ nh String
        const input = data.toString();
        console.log(`Nháº­n: ${input}`);
        
        // 6. Parse chuá»—i thÃ nh 3 sá»‘
        // VÃ­ dá»¥: "1 -5 6" â†’ [1, -5, 6]
        const [a, b, c] = input.split(' ').map(Number);
        
        // 7. Giáº£i phÆ°Æ¡ng trÃ¬nh
        const result = solve(a, b, c);
        console.log(`Gá»­i: ${result}`);
        
        // 8. Gá»­i káº¿t quáº£ vá» client
        socket.write(result);
    });
    
    // 9. Xá»­ lÃ½ khi client ngáº¯t káº¿t ná»‘i
    socket.on('close', () => {
        console.log('Client Ä‘Ã£ ngáº¯t káº¿t ná»‘i\n');
    });
    
    // 10. Xá»­ lÃ½ lá»—i
    socket.on('error', (err) => {
        console.error('Lá»—i:', err.message);
    });
});

// 11. Láº¯ng nghe trÃªn port 5000, IP 127.0.0.1 (localhost)
server.listen(5000, '127.0.0.1', () => {
    console.log('Server Ä‘ang cháº¡y trÃªn 127.0.0.1:5000');
});
```

#### **Client TCP - PhÃ¢n tÃ­ch tá»«ng dÃ²ng:**

```javascript
const net = require('net');
const readline = require('readline');

// 1. Táº¡o socket client
const client = new net.Socket();

// 2. Táº¡o interface Ä‘á»ƒ Ä‘á»c input tá»« console
const rl = readline.createInterface({
    input: process.stdin,   // Äá»c tá»« bÃ n phÃ­m
    output: process.stdout  // Xuáº¥t ra console
});

// 3. Káº¿t ná»‘i Ä‘áº¿n server
// Tham sá»‘: (port, host, callback)
client.connect(5000, '127.0.0.1', () => {
    console.log('âœ“ ÄÃ£ káº¿t ná»‘i Ä‘áº¿n server\n');
    askInput();  // Báº¯t Ä‘áº§u nháº­p liá»‡u
});

// 4. HÃ m há»i ngÆ°á»i dÃ¹ng nháº­p dá»¯ liá»‡u
function askInput() {
    rl.question('Nháº­p a b c: ', (input) => {
        // Gá»­i dá»¯ liá»‡u Ä‘áº¿n server
        client.write(input);
    });
}

#### **LÃ½ thuyáº¿t toÃ¡n há»c:**

**Äiá»u kiá»‡n nhÃ¢n ma tráº­n:**
- Ma tráº­n `A[mÃ—n]` Ã— Ma tráº­n `B[nÃ—p]` = Ma tráº­n `C[mÃ—p]`
- **Quan trá»ng:** Sá»‘ cá»™t cá»§a A pháº£i báº±ng sá»‘ hÃ ng cá»§a B

**CÃ´ng thá»©c:** 
```
C[i][j] = Î£(A[i][k] Ã— B[k][j])  vá»›i k = 0 â†’ n-1
```

**Minh há»a trá»±c quan:**
```
    A (2Ã—3)          B (3Ã—2)       C (2Ã—2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1   2   3  â”‚  â”‚  7   8  â”‚   â”‚ 58  64  â”‚
â”‚  4   5   6  â”‚  â”‚  9  10  â”‚   â”‚139 154  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ 11  12  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

C[0][0] = 1Ã—7 + 2Ã—9 + 3Ã—11 = 7 + 18 + 33 = 58
C[0][1] = 1Ã—8 + 2Ã—10 + 3Ã—12 = 8 + 20 + 36 = 64
C[1][0] = 4Ã—7 + 5Ã—9 + 6Ã—11 = 28 + 45 + 66 = 139
C[1][1] = 4Ã—8 + 5Ã—10 + 6Ã—12 = 32 + 50 + 72 = 154
```

#### **Code chi tiáº¿t vá»›i comments:**

```javascript
/**
 * NhÃ¢n hai ma tráº­n
 * @param {number[][]} A - Ma tráº­n A cÃ³ kÃ­ch thÆ°á»›c mÃ—n
 * @param {number[][]} B - Ma tráº­n B cÃ³ kÃ­ch thÆ°á»›c nÃ—p
 * @returns {number[][]} - Ma tráº­n C cÃ³ kÃ­ch thÆ°á»›c mÃ—p
 */
function multiply(A, B) {
    // 1. Láº¥y kÃ­ch thÆ°á»›c cÃ¡c ma tráº­n
    const m = A.length;           // Sá»‘ hÃ ng cá»§a A
    const n = A[0].length;        // Sá»‘ cá»™t cá»§a A
    const p = B[0].length;        // Sá»‘ cá»™t cá»§a B
    
    // 2. Kiá»ƒm tra Ä‘iá»u kiá»‡n nhÃ¢n Ä‘Æ°á»£c
    if (n !== B.length) {
        throw new Error('KhÃ´ng thá»ƒ nhÃ¢n: sá»‘ cá»™t A â‰  sá»‘ hÃ ng B');
    }
    
    // 3. Khá»Ÿi táº¡o ma tráº­n káº¿t quáº£ C[mÃ—p]
    const C = [];
    
    // 4. VÃ²ng láº·p qua tá»«ng hÃ ng cá»§a C
    for (let i = 0; i < m; i++) {
        C[i] = [];  // Khá»Ÿi táº¡o hÃ ng i
        
        // 5. VÃ²ng láº·p qua tá»«ng cá»™t cá»§a C
        for (let j = 0; j < p; j++) {
            C[i][j] = 0;  // Khá»Ÿi táº¡o pháº§n tá»­ = 0
            
            // 6. TÃ­nh tá»•ng tÃ­ch: C[i][j] = Î£(A[i][k] Ã— B[k][j])
            for (let k = 0; k < n; k++) {
                // Láº¥y pháº§n tá»­ hÃ ng i cá»§a A
                // Láº¥y pháº§n tá»­ cá»™t j cá»§a B
                // NhÃ¢n vÃ  cá»™ng dá»“n
                C[i][j] += A[i][k] * B[k][j];
                
                // Debug: in tá»«ng bÆ°á»›c tÃ­nh
                // console.log(`C[${i}][${j}] += A[${i}][${k}] Ã— B[${k}][${j}]`);
                // console.log(`C[${i}][${j}] += ${A[i][k]} Ã— ${B[k][j]} = ${A[i][k] * B[k][j]}`);
            }
        }
    }
    
    return C;
}
```

#### **VÃ­ dá»¥ chi tiáº¿t tá»«ng bÆ°á»›c:**

```javascript
// Ma tráº­n A (2Ã—2)
const A = [
    [1, 2],
    [3, 4]
];

// Ma tráº­n B (2Ã—2)
const B = [
    [5, 6],
    [7, 8]
];

// TÃ­nh C[0][0]:
// C[0][0] = A[0][0] Ã— B[0][0] + A[0][1] Ã— B[1][0]
//         = 1 Ã— 5 + 2 Ã— 7
//         = 5 + 14
//         = 19

// TÃ­nh C[0][1]:
// C[0][1] = A[0][0] Ã— B[0][1] + A[0][1] Ã— B[1][1]
//         = 1 Ã— 6 + 2 Ã— 8
//         = 6 + 16
//         = 22

// TÃ­nh C[1][0]:
// C[1][0] = A[1][0] Ã— B[0][0] + A[1][1] Ã— B[1][0]
//         = 3 Ã— 5 + 4 Ã— 7
//         = 15 + 28
//         = 43

// TÃ­nh C[1][1]:
// C[1][1] = A[1][0] Ã— B[0][1] + A[1][1] Ã— B[1][1]
//         = 3 Ã— 6 + 4 Ã— 8
//         = 18 + 32
//         = 50

// Káº¿t quáº£:
const C = [
    [19, 22],
    [43, 50]
];
```

### ğŸ” CÃ¡ch gá»­i ma tráº­n qua máº¡ng

#### **PhÆ°Æ¡ng phÃ¡p 1: JSON (Khuyáº¿n nghá»‹)**

**Æ¯u Ä‘iá»ƒm:**
- âœ… Dá»… hiá»ƒu, dá»… debug
- âœ… Há»— trá»£ nhiá»u kiá»ƒu dá»¯ liá»‡u
- âœ… Human-readable

**NhÆ°á»£c Ä‘iá»ƒm:**
- âŒ Tá»‘n bandwidth (kÃ­ch thÆ°á»›c lá»›n)
- âŒ Cháº­m hÆ¡n binary

```javascript
// ========== CLIENT SIDE ==========
const m1 = [[1, 2], [3, 4]];
const m2 = [[5, 6], [7, 8]];

// 1. Serialize thÃ nh JSON string
const payload = JSON.stringify({
    m1: m1,
    m2: m2
});

// 2. Gá»­i qua socket
socket.write(payload);

// KÃ­ch thÆ°á»›c: ~60 bytes
// {"m1":[[1,2],[3,4]],"m2":[[5,6],[7,8]]}


// ========== SERVER SIDE ==========
socket.on('data', (data) => {
    // 1. Parse JSON string thÃ nh object
    const request = JSON.parse(data.toString());
    
    // 2. Láº¥y ra 2 ma tráº­n
    const { m1, m2 } = request;
    
    // 3. Xá»­ lÃ½
    const result = multiply(m1, m2);
    
    // 4. Gá»­i láº¡i káº¿t quáº£
    const response = JSON.stringify({
        result: result,
        status: 'success'
    });
    
    socket.write(response);
});

// CLIENT nháº­n káº¿t quáº£
client.on('data', (data) => {
    const response = JSON.parse(data.toString());
    console.log(response.result);
    // [[19, 22], [43, 50]]
});
```

#### **PhÆ°Æ¡ng phÃ¡p 2: Binary (NÃ¢ng cao)**

**Æ¯u Ä‘iá»ƒm:**
- âœ… Nhá» gá»n, tiáº¿t kiá»‡m bandwidth
- âœ… Nhanh hÆ¡n

**NhÆ°á»£c Ä‘iá»ƒm:**
- âŒ KhÃ³ debug
- âŒ Pháº£i biáº¿t chÃ­nh xÃ¡c format

```javascript
// ========== CLIENT SIDE ==========
function serializeMatrix(m1, m2) {
    // Format: [r1, c1, ...data1, r2, c2, ...data2]
    const r1 = m1.length;
    const c1 = m1[0].length;
    const r2 = m2.length;
    const c2 = m2[0].length;
    
    // TÃ­nh tá»•ng sá»‘ pháº§n tá»­
    const totalSize = 4 + (r1 * c1) + (r2 * c2);
    
    // Táº¡o Buffer (má»—i sá»‘ = 4 bytes = Int32)
    const buffer = Buffer.alloc(totalSize * 4);
    
    let offset = 0;
    
    // Ghi kÃ­ch thÆ°á»›c ma tráº­n 1
    buffer.writeInt32LE(r1, offset); offset += 4;
    buffer.writeInt32LE(c1, offset); offset += 4;
    
    // Ghi dá»¯ liá»‡u ma tráº­n 1
    for (let i = 0; i < r1; i++) {
        for (let j = 0; j < c1; j++) {
            buffer.writeInt32LE(m1[i][j], offset);
            offset += 4;
        }
    }
    
    // Ghi kÃ­ch thÆ°á»›c ma tráº­n 2
    buffer.writeInt32LE(r2, offset); offset += 4;
    buffer.writeInt32LE(c2, offset); offset += 4;
    
    // Ghi dá»¯ liá»‡u ma tráº­n 2
    for (let i = 0; i < r2; i++) {
        for (let j = 0; j < c2; j++) {
            buffer.writeInt32LE(m2[i][j], offset);
            offset += 4;
        }
    }
    
    return buffer;
}

// Gá»­i
const buffer = serializeMatrix(m1, m2);
socket.write(buffer);
// KÃ­ch thÆ°á»›c: 72 bytes (18 sá»‘ Ã— 4 bytes)


// ========== SERVER SIDE ==========
socket.on('data', (buffer) => {
    let offset = 0;
    
    // Äá»c kÃ­ch thÆ°á»›c ma tráº­n 1
    const r1 = buffer.readInt32LE(offset); offset += 4;
    const c1 = buffer.readInt32LE(offset); offset += 4;
    
    // Äá»c dá»¯ liá»‡u ma tráº­n 1
    const m1 = [];
    for (let i = 0; i < r1; i++) {
        m1[i] = [];
        for (let j = 0; j < c1; j++) {
            m1[i][j] = buffer.readInt32LE(offset);
            offset += 4;
        }
    }
    
    // TÆ°Æ¡ng tá»± cho ma tráº­n 2...
});
```

#### **PhÆ°Æ¡ng phÃ¡p 3: CSV/Text (ÄÆ¡n giáº£n)**

```javascript
// CLIENT: Serialize thÃ nh text
const text = `${m1.length},${m1[0].length}\n` +
             m1.map(row => row.join(',')).join('\n') + '\n' +
             `${m2.length},${m2[0].length}\n` +
             m2.map(row => row.join(',')).join('\n');

socket.write(text);

// Format:
// 2,2
// 1,2
// 3,4
// 2,2
// 5,6
// 7,8

// SERVER: Parse text
const lines = data.toString().split('\n');
// ... parse lines ...
```

#### **So sÃ¡nh cÃ¡c phÆ°Æ¡ng phÃ¡p:**

| PhÆ°Æ¡ng phÃ¡p | KÃ­ch thÆ°á»›c | Tá»‘c Ä‘á»™ | Dá»… dÃ¹ng | Debug |
|-------------|-----------|--------|---------|-------|
| JSON | Lá»›n nháº¥t | Cháº­m nháº¥t | â­â­â­â­â­ | â­â­â­â­â­ |
| Binary | Nhá» nháº¥t | Nhanh nháº¥t | â­â­ | â­ |
| CSV/Text | Trung bÃ¬nh | Trung bÃ¬nh | â­â­â­â­ | â­â­â­â­ |

**Khuyáº¿n nghá»‹:** DÃ¹ng **JSON** cho há»c táº­p vÃ  dá»± Ã¡n nhá» server.send(result, rinfo.port, rinfo.address, (err) => {
        if (err) console.error('Lá»—i gá»­i:', err);
    });
});

// 4. Bind (láº¯ng nghe) trÃªn port
server.bind(5000, () => {
    console.log('UDP Server Ä‘ang cháº¡y trÃªn port 5000');
---

## API Reference

### ğŸ“š TCP (module `net`)

#### **Server API:**

```javascript
const net = require('net');

// 1. Táº¡o server
const server = net.createServer([options], [connectionListener]);
```

**Options:**
- `allowHalfOpen` (boolean): Cho phÃ©p half-open TCP connections
- `pauseOnConnect` (boolean): Táº¡m dá»«ng socket khi connect

**Events:**
- `connection`: Khi cÃ³ client káº¿t ná»‘i `(socket) => {}`
- `error`: Khi cÃ³ lá»—i `(err) => {}`
- `close`: Khi server Ä‘Ã³ng `() => {}`
- `listening`: Khi server báº¯t Ä‘áº§u láº¯ng nghe `() => {}`

```javascript
// 2. Láº¯ng nghe trÃªn port
server.listen(port, [host], [backlog], [callback]);
```

**Parameters:**
- `port` (number): Port number (0-65535)
- `host` (string): IP address, máº·c Ä‘á»‹nh '0.0.0.0' (táº¥t cáº£ interfaces)
- `backlog` (number): Max pending connections, máº·c Ä‘á»‹nh 511
- `callback` (function): Gá»i khi server sáºµn sÃ ng

```javascript
// 3. ÄÃ³ng server
server.close([callback]);

// 4. Láº¥y thÃ´ng tin server
server.address();  // { port: 5000, family: 'IPv4', address: '127.0.0.1' }

// 5. Sá»‘ lÆ°á»£ng káº¿t ná»‘i hiá»‡n táº¡i
server.getConnections((err, count) => {
    console.log(`${count} clients connected`);
});
```

#### **Socket API (server-side & client-side):**

```javascript
// 1. Gá»­i dá»¯ liá»‡u
socket.write(data, [encoding], [callback]);
// data: string hoáº·c Buffer
// encoding: 'utf8', 'ascii', 'base64', máº·c Ä‘á»‹nh 'utf8'
// callback: gá»i khi dá»¯ liá»‡u Ä‘Æ°á»£c gá»­i xong

// 2. Káº¿t thÃºc gá»­i dá»¯ liá»‡u
socket.end([data], [encoding]);
// Gá»­i FIN packet, khÃ´ng thá»ƒ gá»­i thÃªm

// 3. ÄÃ³ng ngay láº­p tá»©c
socket.destroy([error]);
// ÄÃ³ng mÃ  khÃ´ng Ä‘á»£i dá»¯ liá»‡u gá»­i xong

// 4. Táº¡m dá»«ng/Tiáº¿p tá»¥c nháº­n dá»¯ liá»‡u
socket.pause();  // Táº¡m dá»«ng event 'data'
socket.resume(); // Tiáº¿p tá»¥c nháº­n

// 5. Thiáº¿t láº­p timeout
socket.setTimeout(milliseconds, [callback]);
// Tá»± Ä‘á»™ng Ä‘Ã³ng sau khoáº£ng thá»i gian khÃ´ng hoáº¡t Ä‘á»™ng

// 6. Thiáº¿t láº­p keep-alive
socket.setKeepAlive([enable], [initialDelay]);

// 7. VÃ´ hiá»‡u hÃ³a Nagle algorithm
socket.setNoDelay([noDelay]);
```

**Socket Properties:**
```javascript
socket.localAddress   // IP local
socket.localPort      // Port local
socket.remoteAddress  // IP remote
socket.remotePort     // Port remote
socket.bytesRead      // Sá»‘ bytes Ä‘Ã£ Ä‘á»c
socket.bytesWritten   // Sá»‘ bytes Ä‘Ã£ ghi
socket.destroyed      // true náº¿u Ä‘Ã£ Ä‘Ã³ng
```

**Socket Events:**
```javascript
socket.on('data', (data) => {});     // Nháº­n dá»¯ liá»‡u
socket.on('close', (hadError) => {}); // ÄÃ³ng káº¿t ná»‘i
socket.on('error', (err) => {});      // Lá»—i
socket.on('end', () => {});           // PhÃ­a bÃªn kia Ä‘Ã³ng
socket.on('timeout', () => {});       // Timeout
socket.on('drain', () => {});         // Buffer trá»‘ng, cÃ³ thá»ƒ ghi tiáº¿p
```

#### **Client API:**

```javascript
// 1. Táº¡o socket
const client = new net.Socket();

// 2. Káº¿t ná»‘i Ä‘áº¿n server
client.connect(port, [host], [connectListener]);
// hoáº·c
client.connect({ port, host }, [connectListener]);

// VÃ­ dá»¥:
client.connect(5000, '127.0.0.1', () => {
    console.log('Connected!');
});
```

### ğŸ“š UDP (module `dgram`)

#### **Socket API:**

```javascript
const dgram = require('dgram');

// 1. Táº¡o socket
const socket = dgram.createSocket(options, [callback]);
// hoáº·c
const socket = dgram.createSocket(type);

// type: 'udp4' (IPv4) hoáº·c 'udp6' (IPv6)
// options: { type, reuseAddr, ipv6Only, recvBufferSize, sendBufferSize }
```

**Methods:**
```javascript
// 2. Bind (láº¯ng nghe) trÃªn port
socket.bind([port], [address], [callback]);
// Máº·c Ä‘á»‹nh: port = random, address = '0.0.0.0'

// 3. Gá»­i dá»¯ liá»‡u
socket.send(msg, [offset], [length], port, address, [callback]);
// msg: Buffer hoáº·c string
// offset, length: vá»‹ trÃ­ vÃ  Ä‘á»™ dÃ i trong buffer
// callback: (err) => {}

// VÃ­ dá»¥:
const msg = Buffer.from('Hello');
socket.send(msg, 5000, '127.0.0.1', (err) => {
    if (err) console.error(err);
});

// 4. ÄÃ³ng socket
socket.close([callback]);

// 5. Láº¥y thÃ´ng tin
socket.address();  // { address, port, family }

// 6. Thiáº¿t láº­p broadcast
socket.setBroadcast(flag);  // true/false

// 7. Thiáº¿t láº­p multicast
socket.addMembership(multicastAddress, [multicastInterface]);
socket.dropMembership(multicastAddress, [multicastInterface]);
socket.setMulticastTTL(ttl);
socket.setMulticastLoopback(flag);
```

**Events:**
```javascript
socket.on('message', (msg, rinfo) => {});
// msg: Buffer
// rinfo: { address, port, family, size }

socket.on('error', (err) => {});
socket.on('close', () => {});
socket.on('listening', () => {});
```

---

## Best Practices

### âœ… Security Best Practices

#### **1. Validate Input**
```javascript
// âŒ BAD: KhÃ´ng validate
socket.on('data', (data) => {
    const nums = data.toString().split(' ').map(Number);
    const result = calculate(nums[0], nums[1]);  // CÃ³ thá»ƒ undefined/NaN
});

// âœ… GOOD: Validate Ä‘áº§y Ä‘á»§
socket.on('data', (data) => {
    try {
        const input = data.toString().trim();
        
        // Check length
        if (input.length > 1000) {
            throw new Error('Input quÃ¡ dÃ i');
        }
        
        // Parse vÃ  validate
        const nums = input.split(' ').map(Number);
        
        if (nums.length !== 2) {
            throw new Error('Pháº£i nháº­p Ä‘Ãºng 2 sá»‘');
        }
        
        if (nums.some(isNaN)) {
            throw new Error('Dá»¯ liá»‡u khÃ´ng há»£p lá»‡');
        }
        
        const result = calculate(nums[0], nums[1]);
        socket.write(result.toString());
        
    } catch (err) {
        socket.write(`Lá»—i: ${err.message}`);
    }
});
```

#### **2. Sanitize Data**
```javascript
// âŒ BAD: SQL Injection risk
const query = `SELECT * FROM users WHERE name = '${username}'`;

// âœ… GOOD: Use parameterized queries
const query = 'SELECT * FROM users WHERE name = ?';
db.query(query, [username]);
```

#### **3. Rate Limiting**
```javascript
// Giá»›i háº¡n sá»‘ request/giÃ¢y
const rateLimit = new Map();

socket.on('data', (data) => {
    const clientKey = `${socket.remoteAddress}:${socket.remotePort}`;
    const now = Date.now();
    const requests = rateLimit.get(clientKey) || [];
    
    // XÃ³a request cÅ© hÆ¡n 1 giÃ¢y
    const recent = requests.filter(time => now - time < 1000);
    
    if (recent.length >= 10) {
        socket.write('ERROR: QuÃ¡ nhiá»u request. Vui lÃ²ng thá»­ láº¡i sau.');
        return;
    }
    
    recent.push(now);
    rateLimit.set(clientKey, recent);
    
    // Xá»­ lÃ½ request...
});
```

#### **4. Timeout Protection**
```javascript
// Äáº·t timeout Ä‘á»ƒ trÃ¡nh connection treo
socket.setTimeout(30000);  // 30 giÃ¢y

socket.on('timeout', () => {
    console.log('Socket timeout. ÄÃ³ng káº¿t ná»‘i.');
    socket.destroy();
});
```

### âœ… Error Handling

```javascript
// âŒ BAD: KhÃ´ng xá»­ lÃ½ lá»—i
socket.on('data', (data) => {
    const obj = JSON.parse(data);  // CÃ³ thá»ƒ throw exception
    processData(obj);
});

// âœ… GOOD: Xá»­ lÃ½ Ä‘áº§y Ä‘á»§
socket.on('data', (data) => {
    try {
        const obj = JSON.parse(data.toString());
        processData(obj);
    } catch (err) {
        console.error('Parse error:', err.message);
        socket.write(JSON.stringify({
            error: 'Invalid JSON format'
        }));
    }
});

// Báº¯t táº¥t cáº£ lá»—i socket
socket.on('error', (err) => {
    console.error(`Socket error: ${err.message}`);
    // KhÃ´ng throw, sáº½ crash app
});

// Server error handling
server.on('error', (err) => {
    if (err.code === 'EADDRINUSE') {
        console.error('Port Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng');
    } else {
        console.error('Server error:', err);
    }
});
```

### âœ… Performance Optimization

#### **1. Buffer Pooling**
```javascript
// âŒ BAD: Táº¡o Buffer má»›i má»—i láº§n
socket.on('data', (data) => {
    const response = Buffer.from(processData(data));
    socket.write(response);
});

// âœ… GOOD: TÃ¡i sá»­ dá»¥ng Buffer
const bufferPool = Buffer.allocUnsafe(1024);
let bufferOffset = 0;

socket.on('data', (data) => {
    const result = processData(data);
    const length = bufferPool.write(result, bufferOffset);
    socket.write(bufferPool.slice(bufferOffset, bufferOffset + length));
    
    bufferOffset = (bufferOffset + length) % 1024;
});
```

#### **2. Batch Processing**
```javascript
// Gá»™p nhiá»u message nhá» thÃ nh 1 packet lá»›n
let messageQueue = [];
let flushTimer = null;

function sendMessage(msg) {
    messageQueue.push(msg);
    
    if (!flushTimer) {
        flushTimer = setTimeout(() => {
            const batch = messageQueue.join('\n');
            socket.write(batch);
            messageQueue = [];
            flushTimer = null;
        }, 10);  // Äá»£i 10ms Ä‘á»ƒ gá»™p
    }
}
```

#### **3. Streaming Large Data**
```javascript
const fs = require('fs');

// âŒ BAD: Äá»c toÃ n bá»™ file vÃ o memory
const data = fs.readFileSync('large-file.dat');
socket.write(data);  // CÃ³ thá»ƒ out of memory

// âœ… GOOD: Stream file
const stream = fs.createReadStream('large-file.dat');
stream.pipe(socket);
```

### âœ… Code Organization

```javascript
// TÃ¡ch logic xá»­ lÃ½ ra khá»i network code
class MessageHandler {
    handleCalculation(a, b, c) {
        // Business logic
    }
    
    handleMatrixMultiply(m1, m2) {
        // Business logic
    }
}

class SocketServer {
    constructor(port, handler) {
        this.port = port;
        this.handler = handler;
        this.server = net.createServer(this.handleConnection.bind(this));
    }
    
    handleConnection(socket) {
        socket.on('data', (data) => {
            try {
                const request = JSON.parse(data.toString());
                const result = this.handler.handleRequest(request);
                socket.write(JSON.stringify(result));
            } catch (err) {
                this.handleError(socket, err);
            }
        });
    }
    
    handleError(socket, err) {
        socket.write(JSON.stringify({ error: err.message }));
    }
    
    start() {
        this.server.listen(this.port);
    }
}

// Sá»­ dá»¥ng
const handler = new MessageHandler();
const server = new SocketServer(5000, handler);
server.start();
```

---

});
```

#### **UDP Client - Sá»± khÃ¡c biá»‡t:**

```javascript
const dgram = require('dgram');
const client = dgram.createSocket('udp4');

// 1. KhÃ´ng cáº§n connect, gá»­i trá»±c tiáº¿p
function sendData(input) {
    const message = Buffer.from(input);
    
    // 2. Gá»­i message, pháº£i chá»‰ Ä‘á»‹nh port vÃ  host
    client.send(message, 5000, '127.0.0.1', (err) => {
        if (err) {
            console.error('Lá»—i:', err);
            client.close();
        } else {
            console.log('ÄÃ£ gá»­i');
        }
    });
}

// 3. Láº¯ng nghe pháº£n há»“i
client.on('message', (msg) => {
    console.log(`â†’ ${msg.toString()}`);
});

// VÃ­ dá»¥ sá»­ dá»¥ng
sendData('1 -5 6');
```

#### **So sÃ¡nh TCP vs UDP:**

| Aspect | TCP | UDP |
|--------|-----|-----|
| **Connection** | `client.connect()` | KhÃ´ng cáº§n |
| **Send** | `socket.write(data)` | `socket.send(data, port, host)` |
| **Receive** | `socket.on('data')` | `socket.on('message')` |
| **Server callback** | `createServer((socket) => {})` | KhÃ´ng cÃ³ callback |
| **Client info** | `socket.remoteAddress` | `rinfo` parameter |
| **Auto response** | `socket.write()` tá»± biáº¿t gá»­i cho ai | Pháº£i chá»‰ Ä‘á»‹nh `port, address` |

---

## BÃ i 2: NhÃ¢n hai ma tráº­n

### ğŸ“ MÃ´ táº£
Client gá»­i 2 ma tráº­n Ä‘áº¿n server. Server tÃ­nh tÃ­ch 2 ma tráº­n vÃ  gá»­i káº¿t quáº£ vá».

### ğŸš€ CÃ¡ch cháº¡y
```bash
node 2_tcp_server.js  # hoáº·c 2_udp_server.js
node 2_tcp_client.js  # hoáº·c 2_udp_client.js
```

### ğŸ’¡ VÃ­ dá»¥
```
A (r c): 2 2
Nháº­p 4 sá»‘: 1 2 3 4

B (r c): 2 2
Nháº­p 4 sá»‘: 5 6 7 8

AÃ—B:
  19  22
  43  50
```

### ğŸ” Giáº£i thÃ­ch thuáº­t toÃ¡n nhÃ¢n ma tráº­n

**CÃ´ng thá»©c:** `C[i][j] = Î£(A[i][k] Ã— B[k][j])`

```javascript
function multiply(A, B) {
    const m = A.length;        // Sá»‘ hÃ ng A
    const n = B.length;        // Sá»‘ cá»™t A = sá»‘ hÃ ng B
    const p = B[0].length;     // Sá»‘ cá»™t B
    
    const C = [];
    for (let i = 0; i < m; i++) {
        C[i] = [];
        for (let j = 0; j < p; j++) {
            C[i][j] = 0;
            // TÃ­nh tá»•ng tÃ­ch
            for (let k = 0; k < n; k++) {
                C[i][j] += A[i][k] * B[k][j];
            }
        }
    }
    return C;
}
```

**VÃ­ dá»¥ cá»¥ thá»ƒ:**
```
A = [1 2]    B = [5 6]
    [3 4]        [7 8]

C[0][0] = 1Ã—5 + 2Ã—7 = 5 + 14 = 19
C[0][1] = 1Ã—6 + 2Ã—8 = 6 + 16 = 22
C[1][0] = 3Ã—5 + 4Ã—7 = 15 + 28 = 43
C[1][1] = 3Ã—6 + 4Ã—8 = 18 + 32 = 50

Káº¿t quáº£: [19 22]
         [43 50]
```

### ğŸ” CÃ¡ch gá»­i ma tráº­n qua máº¡ng

**Sá»­ dá»¥ng JSON:**
```javascript
// Client gá»­i
const data = JSON.stringify({
    m1: [[1,2],[3,4]],
    m2: [[5,6],[7,8]]
});
socket.write(data);

// Server nháº­n
const { m1, m2 } = JSON.parse(data.toString());
```

---

## BÃ i 3: Thay tháº¿ chuá»—i trong file

### ğŸ“ MÃ´ táº£
Client gá»­i:
- Ná»™i dung file text
- Chuá»—i cáº§n tÃ¬m (s1)
- Chuá»—i thay tháº¿ (s2)

Server thay tháº¿ táº¥t cáº£ `s1` báº±ng `s2` vÃ  gá»­i file káº¿t quáº£ vá».

### ğŸš€ CÃ¡ch cháº¡y
```bash
node 3_tcp_server.js  # hoáº·c 3_udp_server.js
node 3_tcp_client.js  # hoáº·c 3_udp_client.js
```

### ğŸ’¡ VÃ­ dá»¥

**File test.txt:**
```
Hello world
This is a test file
Hello everyone
```

**Thá»±c hiá»‡n:**
```
ÄÆ°á»ng dáº«n file: test.txt
Chuá»—i cáº§n thay tháº¿ (s1): Hello
Chuá»—i thay tháº¿ (s2): Hi
LÆ°u káº¿t quáº£ vÃ o file: result.txt
âœ“ ÄÃ£ thay tháº¿ 2 láº§n
```

**File result.txt:**
```
Hi world
This is a test file
Hi everyone
```

### ğŸ” Giáº£i thÃ­ch code

**Äá»c file:**
```javascript
const fs = require('fs');

// Äá»c file Ä‘á»“ng bá»™
const content = fs.readFileSync('test.txt', 'utf8');
```

**Thay tháº¿ chuá»—i:**
```javascript
function replaceAll(content, s1, s2) {
    // CÃ¡ch 1: DÃ¹ng split vÃ  join
    return content.split(s1).join(s2);
    
    // CÃ¡ch 2: DÃ¹ng replaceAll (ES2021)
    // return content.replaceAll(s1, s2);
}
```

**Äáº¿m sá»‘ láº§n xuáº¥t hiá»‡n:**
```javascript
const count = content.split(s1).length - 1;
```

**Ghi file:**
```javascript
fs.writeFileSync('result.txt', newContent, 'utf8');
```

---

## BÃ i 4: Xá»­ lÃ½ chuá»—i

### ğŸ“ MÃ´ táº£
Server cung cáº¥p cÃ¡c lá»‡nh xá»­ lÃ½ chuá»—i:
- `UPPER`: Chuyá»ƒn chá»¯ thÆ°á»ng â†’ HOA
- `LOWER`: Chuyá»ƒn chá»¯ HOA â†’ thÆ°á»ng
- `DELETE`: XÃ³a má»™t pháº§n chuá»—i
- `INSERT`: ChÃ¨n chuá»—i con

### ğŸš€ CÃ¡ch cháº¡y
```bash
node 4_tcp_server.js  # hoáº·c 4_udp_server.js
node 4_tcp_client.js  # hoáº·c 4_udp_client.js
```

### ğŸ’¡ VÃ­ dá»¥ cÃ¡c lá»‡nh

```bash
# Chuyá»ƒn HOA
Nháº­p lá»‡nh: UPPER|hello world
â†’ HELLO WORLD

# Chuyá»ƒn thÆ°á»ng
Nháº­p lá»‡nh: LOWER|HELLO WORLD
â†’ hello world

# XÃ³a kÃ½ tá»± tá»« vá»‹ trÃ­ 0 Ä‘áº¿n 5
Nháº­p lá»‡nh: DELETE|hello world|0|5
â†’  world

# ChÃ¨n " beautiful" vÃ o vá»‹ trÃ­ 5
Nháº­p lá»‡nh: INSERT|hello world|5| beautiful
â†’ hello beautiful world
```

### ğŸ” Giáº£i thÃ­ch code

**Protocol thiáº¿t káº¿:**
```
Format: COMMAND|text|param1|param2
PhÃ¢n tÃ¡ch báº±ng dáº¥u |
```

**Server xá»­ lÃ½:**
```javascript
function processCommand(cmd, text, ...params) {
    switch(cmd) {
        case 'UPPER':
            return text.toUpperCase();
        
        case 'LOWER':
            return text.toLowerCase();
        
        case 'DELETE':
            const [start, end] = params.map(Number);
            // Cáº¯t tá»« 0->start, ná»‘i vá»›i end->cuá»‘i
            return text.slice(0, start) + text.slice(end);
        
        case 'INSERT':
            const pos = Number(params[0]);
            const substr = params[1];
            // Cáº¯t 0->pos, chÃ¨n substr, ná»‘i pos->cuá»‘i
            return text.slice(0, pos) + substr + text.slice(pos);
        
        default:
            return 'Lá»‡nh khÃ´ng há»£p lá»‡';
    }
}
```

**Client gá»­i:**
```javascript
// Parse input
const parts = data.toString().split('|');
const [cmd, text, ...params] = parts;

// Xá»­ lÃ½
const result = processCommand(cmd, text, ...params);
```

---

## BÃ i 5: Chat room

### ğŸ“ MÃ´ táº£
Táº¡o phÃ²ng chat cho phÃ©p nhiá»u mÃ¡y tÃ­nh trao Ä‘á»•i thÃ´ng tin. Má»—i tin nháº¯n Ä‘Æ°á»£c broadcast Ä‘áº¿n táº¥t cáº£ client khÃ¡c.

### ğŸš€ CÃ¡ch cháº¡y

```bash
# Terminal 1: Server
node 5_tcp_server.js  # hoáº·c 5_udp_server.js

# Terminal 2, 3, 4...: Nhiá»u client
node 5_tcp_client.js  # hoáº·c 5_udp_client.js
```

### ğŸ’¡ VÃ­ dá»¥

**Terminal 1 (Alice):**
```
Nháº­p tÃªn: Alice
[SERVER] Alice Ä‘Ã£ tham gia chat!
> Hello everyone!
âœ“ ÄÃ£ gá»­i
[Bob]: Hi Alice!
```

**Terminal 2 (Bob):**
```
Nháº­p tÃªn: Bob
[Alice]: Hello everyone!
> Hi Alice!
âœ“ ÄÃ£ gá»­i
```

### ğŸ” Giáº£i thÃ­ch code

**Server quáº£n lÃ½ danh sÃ¡ch client:**
```javascript
const clients = [];  // Máº£ng lÆ°u táº¥t cáº£ socket

server.on('connection', (socket) => {
    // ThÃªm client má»›i
    clients.push({ socket, username });
    
    socket.on('data', (data) => {
        const message = data.toString();
        
        // Broadcast cho táº¥t cáº£ (trá»« ngÆ°á»i gá»­i)
        broadcast(message, socket);
    });
    
    socket.on('close', () => {
        // XÃ³a client khi disconnect
        const index = clients.indexOf(socket);
        clients.splice(index, 1);
    });
});
```

**HÃ m broadcast:**
```javascript
function broadcast(message, exclude = null) {
    clients.forEach(client => {
        // KhÃ´ng gá»­i láº¡i cho ngÆ°á»i gá»­i
        if (client.socket !== exclude) {
            client.socket.write(message + '\n');
        }
    });
}
```

**UDP Chat (khÃ¡c biá»‡t):**
```javascript
// UDP khÃ´ng cÃ³ "connection", pháº£i track clients thá»§ cÃ´ng
const clients = new Map();  // Map<"ip:port", username>

server.on('message', (msg, rinfo) => {
    const key = `${rinfo.address}:${rinfo.port}`;
    
    // LÆ°u thÃ´ng tin client
    clients.set(key, username);
    
    // Broadcast
    clients.forEach((username, clientKey) => {
        const [addr, port] = clientKey.split(':');
        server.send(msg, parseInt(port), addr);
    });
});
```

---

## So sÃ¡nh TCP vs UDP

### ğŸ“Š Báº£ng so sÃ¡nh

| TiÃªu chÃ­ | TCP | UDP |
|----------|-----|-----|
| **Káº¿t ná»‘i** | CÃ³ (3-way handshake) | KhÃ´ng |
| **Äá»™ tin cáº­y** | Äáº£m báº£o gá»­i Ä‘áº¿n | KhÃ´ng Ä‘áº£m báº£o |
| **Thá»© tá»±** | ÄÃºng thá»© tá»± | CÃ³ thá»ƒ sai thá»© tá»± |
| **Tá»‘c Ä‘á»™** | Cháº­m hÆ¡n | Nhanh hÆ¡n |
| **Overhead** | Lá»›n | Nhá» |
| **Module Node.js** | `net` | `dgram` |
| **Táº¡o server** | `net.createServer()` | `dgram.createSocket('udp4')` |
| **Gá»­i dá»¯ liá»‡u** | `socket.write()` | `socket.send(msg, port, host)` |
| **Nháº­n dá»¯ liá»‡u** | `socket.on('data')` | `socket.on('message')` |
| **Use case** | File transfer, Chat | Streaming, Gaming |

### ğŸ’» Code so sÃ¡nh

**TCP:**
```javascript
// Server
const net = require('net');
const server = net.createServer((socket) => {
    socket.on('data', (data) => {
        socket.write('Response');
    });
});
server.listen(5000);

// Client
const client = new net.Socket();
client.connect(5000, '127.0.0.1');
client.write('Hello');
```

**UDP:**
```javascript
// Server
const dgram = require('dgram');
const server = dgram.createSocket('udp4');
server.on('message', (msg, rinfo) => {
    server.send('Response', rinfo.port, rinfo.address);
});
server.bind(5000);

// Client
const client = dgram.createSocket('udp4');
const msg = Buffer.from('Hello');
client.send(msg, 5000, '127.0.0.1');
```

---

## ğŸ¯ Khi nÃ o dÃ¹ng TCP vs UDP?

### DÃ¹ng TCP khi:
- âœ… Cáº§n Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº¿n Ä‘Ã­ch
- âœ… Thá»© tá»± tin nháº¯n quan trá»ng
- âœ… VÃ­ dá»¥: Chat, file transfer, email

### DÃ¹ng UDP khi:
- âœ… Tá»‘c Ä‘á»™ quan trá»ng hÆ¡n Ä‘á»™ tin cáº­y
- âœ… Cháº¥p nháº­n máº¥t má»™t Ã­t dá»¯ liá»‡u
- âœ… VÃ­ dá»¥: Video streaming, game online, DNS

---

## ğŸ”§ Troubleshooting

### Lá»—i thÆ°á»ng gáº·p:

**1. `EADDRINUSE` - Port Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng**
```bash
# TÃ¬m process Ä‘ang dÃ¹ng port
netstat -ano | findstr :5000

# Kill process (Windows)
taskkill /PID <PID> /F
```

**2. `ECONNREFUSED` - KhÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c**
- Kiá»ƒm tra server Ä‘Ã£ cháº¡y chÆ°a
- Kiá»ƒm tra port vÃ  IP Ä‘Ãºng khÃ´ng
- Kiá»ƒm tra firewall

**3. Client khÃ´ng nháº­n Ä‘Æ°á»£c dá»¯ liá»‡u**
- TCP: Kiá»ƒm tra `socket.write()` vÃ  `socket.on('data')`
- UDP: Kiá»ƒm tra `socket.send()` vÃ  `socket.on('message')`

---

## ğŸ“š TÃ i liá»‡u tham kháº£o

- [Node.js Net Documentation](https://nodejs.org/api/net.html)
- [Node.js Dgram Documentation](https://nodejs.org/api/dgram.html)
- [TCP/IP Protocol](https://en.wikipedia.org/wiki/Transmission_Control_Protocol)
- [UDP Protocol](https://en.wikipedia.org/wiki/User_Datagram_Protocol)

---

## âœ… Checklist há»c táº­p

- [ ] Hiá»ƒu khÃ¡c biá»‡t TCP vs UDP
- [ ] Biáº¿t cÃ¡ch táº¡o server/client vá»›i `net` vÃ  `dgram`
- [ ] Biáº¿t cÃ¡ch gá»­i/nháº­n dá»¯ liá»‡u
- [ ] Biáº¿t serialize/deserialize data (JSON)
- [ ] Hiá»ƒu event-driven programming
- [ ] Biáº¿t xá»­ lÃ½ nhiá»u client (broadcast)
- [ ] Biáº¿t xá»­ lÃ½ lá»—i vÃ  disconnect

---

**ğŸ‰ ChÃºc báº¡n há»c tá»‘t!**
